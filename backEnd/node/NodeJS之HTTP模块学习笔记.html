<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ã€Nodeã€‘NodeJSä¹‹HTTPæ¨¡å—å­¦ä¹ ç¬”è®° | èƒ¡å‰‘é”‹</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="./images/avatar.jpg">
    <link rel="manifest" href="./data/manifest.json">
    <meta name="description" content="å‹¿å¿˜åˆå¿ƒ,æ–¹å¾—å§‹ç»ˆ! Welcome to Hu Jianfeng's blog">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="keywords" content="vuepress, blog, å‰ç«¯, HTML5, CSS3ï¼Œjavascript, typescript">
    <meta name="copyright" content="zkk">
    <meta name="robots" content="all">
    <link rel="preload" href="/my-blog/assets/css/0.styles.46f68954.css" as="style"><link rel="preload" href="/my-blog/assets/js/app.237f5998.js" as="script"><link rel="preload" href="/my-blog/assets/js/4.c3b56a13.js" as="script"><link rel="preload" href="/my-blog/assets/js/1.f2d47305.js" as="script"><link rel="preload" href="/my-blog/assets/js/16.d2346b3e.js" as="script"><link rel="preload" href="/my-blog/assets/js/10.020a3d41.js" as="script"><link rel="prefetch" href="/my-blog/assets/js/11.37fe3fae.js"><link rel="prefetch" href="/my-blog/assets/js/12.f030fdbb.js"><link rel="prefetch" href="/my-blog/assets/js/13.94d41511.js"><link rel="prefetch" href="/my-blog/assets/js/14.85b24bae.js"><link rel="prefetch" href="/my-blog/assets/js/15.5d20b2b8.js"><link rel="prefetch" href="/my-blog/assets/js/17.37d71494.js"><link rel="prefetch" href="/my-blog/assets/js/18.dd25b827.js"><link rel="prefetch" href="/my-blog/assets/js/19.cc26fb1d.js"><link rel="prefetch" href="/my-blog/assets/js/20.23e2ade8.js"><link rel="prefetch" href="/my-blog/assets/js/21.56e96266.js"><link rel="prefetch" href="/my-blog/assets/js/22.6c93a89b.js"><link rel="prefetch" href="/my-blog/assets/js/23.2ac66780.js"><link rel="prefetch" href="/my-blog/assets/js/24.38abac30.js"><link rel="prefetch" href="/my-blog/assets/js/25.1a4c693a.js"><link rel="prefetch" href="/my-blog/assets/js/26.dc86eb40.js"><link rel="prefetch" href="/my-blog/assets/js/27.3dc78914.js"><link rel="prefetch" href="/my-blog/assets/js/28.17f3b181.js"><link rel="prefetch" href="/my-blog/assets/js/29.d30f5d15.js"><link rel="prefetch" href="/my-blog/assets/js/30.a7e68c9d.js"><link rel="prefetch" href="/my-blog/assets/js/31.d8573e77.js"><link rel="prefetch" href="/my-blog/assets/js/32.cdcbe735.js"><link rel="prefetch" href="/my-blog/assets/js/33.135198be.js"><link rel="prefetch" href="/my-blog/assets/js/34.7e5632da.js"><link rel="prefetch" href="/my-blog/assets/js/35.ac32232b.js"><link rel="prefetch" href="/my-blog/assets/js/36.8029c5ea.js"><link rel="prefetch" href="/my-blog/assets/js/37.acd0cfdd.js"><link rel="prefetch" href="/my-blog/assets/js/38.743e6dbc.js"><link rel="prefetch" href="/my-blog/assets/js/39.67a4dbd0.js"><link rel="prefetch" href="/my-blog/assets/js/40.fbf073d1.js"><link rel="prefetch" href="/my-blog/assets/js/41.0fdc286d.js"><link rel="prefetch" href="/my-blog/assets/js/42.60e051b0.js"><link rel="prefetch" href="/my-blog/assets/js/43.6908382a.js"><link rel="prefetch" href="/my-blog/assets/js/44.5a25597d.js"><link rel="prefetch" href="/my-blog/assets/js/45.6d74a589.js"><link rel="prefetch" href="/my-blog/assets/js/46.5b8c15bd.js"><link rel="prefetch" href="/my-blog/assets/js/47.4e4f45db.js"><link rel="prefetch" href="/my-blog/assets/js/48.1b4f5e72.js"><link rel="prefetch" href="/my-blog/assets/js/49.9cba3429.js"><link rel="prefetch" href="/my-blog/assets/js/5.8d8fa40e.js"><link rel="prefetch" href="/my-blog/assets/js/50.84f40ed2.js"><link rel="prefetch" href="/my-blog/assets/js/51.3c26b63b.js"><link rel="prefetch" href="/my-blog/assets/js/52.85e78493.js"><link rel="prefetch" href="/my-blog/assets/js/53.79c97a9d.js"><link rel="prefetch" href="/my-blog/assets/js/54.31ba2cbc.js"><link rel="prefetch" href="/my-blog/assets/js/55.54891ef5.js"><link rel="prefetch" href="/my-blog/assets/js/56.4a5fec84.js"><link rel="prefetch" href="/my-blog/assets/js/57.9eaefaea.js"><link rel="prefetch" href="/my-blog/assets/js/58.ecc94580.js"><link rel="prefetch" href="/my-blog/assets/js/59.45199777.js"><link rel="prefetch" href="/my-blog/assets/js/6.292df98b.js"><link rel="prefetch" href="/my-blog/assets/js/60.8a1c7381.js"><link rel="prefetch" href="/my-blog/assets/js/61.b81a8de2.js"><link rel="prefetch" href="/my-blog/assets/js/62.faaf609d.js"><link rel="prefetch" href="/my-blog/assets/js/63.a9fe9a94.js"><link rel="prefetch" href="/my-blog/assets/js/64.dde6a6a2.js"><link rel="prefetch" href="/my-blog/assets/js/65.d6705f11.js"><link rel="prefetch" href="/my-blog/assets/js/66.319548eb.js"><link rel="prefetch" href="/my-blog/assets/js/67.4f546884.js"><link rel="prefetch" href="/my-blog/assets/js/68.ad4bc338.js"><link rel="prefetch" href="/my-blog/assets/js/69.86fd44cc.js"><link rel="prefetch" href="/my-blog/assets/js/7.3d84da45.js"><link rel="prefetch" href="/my-blog/assets/js/70.d5efddf9.js"><link rel="prefetch" href="/my-blog/assets/js/71.f166eee1.js"><link rel="prefetch" href="/my-blog/assets/js/72.d7a8a34a.js"><link rel="prefetch" href="/my-blog/assets/js/73.515cbafc.js"><link rel="prefetch" href="/my-blog/assets/js/74.cfbca9bf.js"><link rel="prefetch" href="/my-blog/assets/js/75.0da03016.js"><link rel="prefetch" href="/my-blog/assets/js/76.1d250543.js"><link rel="prefetch" href="/my-blog/assets/js/77.0387383f.js"><link rel="prefetch" href="/my-blog/assets/js/78.61a6212c.js"><link rel="prefetch" href="/my-blog/assets/js/79.3febe468.js"><link rel="prefetch" href="/my-blog/assets/js/8.a1757340.js"><link rel="prefetch" href="/my-blog/assets/js/80.893b34f8.js"><link rel="prefetch" href="/my-blog/assets/js/81.8db911d8.js"><link rel="prefetch" href="/my-blog/assets/js/82.37ab1dc1.js"><link rel="prefetch" href="/my-blog/assets/js/83.38de727f.js"><link rel="prefetch" href="/my-blog/assets/js/84.0dc53305.js"><link rel="prefetch" href="/my-blog/assets/js/85.1ab765d7.js"><link rel="prefetch" href="/my-blog/assets/js/86.aaf860fa.js"><link rel="prefetch" href="/my-blog/assets/js/87.9364427c.js"><link rel="prefetch" href="/my-blog/assets/js/88.7ebd5a02.js"><link rel="prefetch" href="/my-blog/assets/js/9.6b8f3db8.js"><link rel="prefetch" href="/my-blog/assets/js/vendors~flowchart.c869d7ce.js">
    <link rel="stylesheet" href="/my-blog/assets/css/0.styles.46f68954.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-19557b78><div data-v-19557b78><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-19557b78 data-v-19557b78><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-19557b78 data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>èƒ¡å‰‘é”‹</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>ç§¦æ˜Šjoyc</span>
          Â Â 
          <!---->
          2020
        </a></span></div></div> <div class="hide" data-v-19557b78><header class="navbar" data-v-19557b78><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-blog/" class="home-link router-link-active"><img src="/my-blog/images/avatar.jpg" alt="èƒ¡å‰‘é”‹" class="logo"> <span class="site-name">èƒ¡å‰‘é”‹</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-blog/" class="nav-link"><i class="iconfont reco-home"></i>
  ä¸»é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      å‰ç«¯
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>åŸºç¡€</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-blog/tag/CSS/" class="nav-link"><i class="iconfont undefined"></i>
  CSS
</a></li><li class="dropdown-subitem"><a href="/my-blog/tag/JS/" class="nav-link"><i class="iconfont undefined"></i>
  JS
</a></li></ul></li><li class="dropdown-item"><h4>æ¡†æ¶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-blog/tag/vue/" class="nav-link"><i class="iconfont undefined"></i>
  vue
</a></li><li class="dropdown-subitem"><a href="/my-blog/tag/vue/" class="nav-link"><i class="iconfont undefined"></i>
  angular
</a></li><li class="dropdown-subitem"><a href="/my-blog/tag/vue/" class="nav-link"><i class="iconfont undefined"></i>
  react
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-coding"></i>
      åç«¯
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Node</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-blog/backEnd/node/" class="nav-link router-link-active"><i class="iconfont undefined"></i>
  nodeåŸºç¡€
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-other"></i>
      å…¶ä»–
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/other/git/" class="nav-link"><i class="iconfont undefined"></i>
  Git
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/å…¶ä»–æŠ€æœ¯/http/" class="nav-link"><i class="iconfont undefined"></i>
  HTTP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      åˆ†ç±»
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/categories/åç«¯/" class="nav-link"><i class="iconfont undefined"></i>
  åç«¯
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/categories/å‰ç«¯/" class="nav-link"><i class="iconfont undefined"></i>
  å‰ç«¯
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/categories/å…¶ä»–/" class="nav-link"><i class="iconfont undefined"></i>
  å…¶ä»–
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/categories/webpack/" class="nav-link"><i class="iconfont undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/categories/æ€§èƒ½ä¼˜åŒ–/" class="nav-link"><i class="iconfont undefined"></i>
  æ€§èƒ½ä¼˜åŒ–
</a></li></ul></div></div><div class="nav-item"><a href="/my-blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  æ ‡ç­¾
</a></div> <a href="https://github.com/qinhao305292690" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask" data-v-19557b78></div> <aside class="sidebar" data-v-19557b78><div class="personal-info-wrapper" data-v-042e23d4><img src="/my-blog/images/avatar.jpg" alt="author-avatar" class="personal-img" data-v-042e23d4> <h3 class="name" data-v-042e23d4>
    ç§¦æ˜Šjoyc
  </h3> <div class="num" data-v-042e23d4><div data-v-042e23d4><h3 data-v-042e23d4>58</h3> <h6 data-v-042e23d4>æ–‡ç« </h6></div> <div data-v-042e23d4><h3 data-v-042e23d4>14</h3> <h6 data-v-042e23d4>æ ‡ç­¾</h6></div></div> <hr data-v-042e23d4></div> <nav class="nav-links"><div class="nav-item"><a href="/my-blog/" class="nav-link"><i class="iconfont reco-home"></i>
  ä¸»é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      å‰ç«¯
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>åŸºç¡€</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-blog/tag/CSS/" class="nav-link"><i class="iconfont undefined"></i>
  CSS
</a></li><li class="dropdown-subitem"><a href="/my-blog/tag/JS/" class="nav-link"><i class="iconfont undefined"></i>
  JS
</a></li></ul></li><li class="dropdown-item"><h4>æ¡†æ¶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-blog/tag/vue/" class="nav-link"><i class="iconfont undefined"></i>
  vue
</a></li><li class="dropdown-subitem"><a href="/my-blog/tag/vue/" class="nav-link"><i class="iconfont undefined"></i>
  angular
</a></li><li class="dropdown-subitem"><a href="/my-blog/tag/vue/" class="nav-link"><i class="iconfont undefined"></i>
  react
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-coding"></i>
      åç«¯
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Node</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/my-blog/backEnd/node/" class="nav-link router-link-active"><i class="iconfont undefined"></i>
  nodeåŸºç¡€
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-other"></i>
      å…¶ä»–
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/other/git/" class="nav-link"><i class="iconfont undefined"></i>
  Git
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/å…¶ä»–æŠ€æœ¯/http/" class="nav-link"><i class="iconfont undefined"></i>
  HTTP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      åˆ†ç±»
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/categories/åç«¯/" class="nav-link"><i class="iconfont undefined"></i>
  åç«¯
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/categories/å‰ç«¯/" class="nav-link"><i class="iconfont undefined"></i>
  å‰ç«¯
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/categories/å…¶ä»–/" class="nav-link"><i class="iconfont undefined"></i>
  å…¶ä»–
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/categories/webpack/" class="nav-link"><i class="iconfont undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/categories/æ€§èƒ½ä¼˜åŒ–/" class="nav-link"><i class="iconfont undefined"></i>
  æ€§èƒ½ä¼˜åŒ–
</a></li></ul></div></div><div class="nav-item"><a href="/my-blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  æ ‡ç­¾
</a></div> <a href="https://github.com/qinhao305292690" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>NodeJSå­¦ä¹ ç¬”è®°</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/my-blog/backEnd/node/Expressæ¡†æ¶å­¦ä¹ ç¬”è®°.html" class="sidebar-link">ã€Nodeã€‘Express web å¼€å‘æ¡†æ¶å­¦ä¹ ç¬”è®°</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>ã€Nodeã€‘NodeJSä¹‹HTTPæ¨¡å—å­¦ä¹ ç¬”è®°</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>ç§¦æ˜Šjoyc</span>
          Â Â 
          <!---->
          2020
        </a></span></div></div> <div data-v-19557b78><main class="page"><div class="page-title" style="display:none;"><h1>ã€Nodeã€‘NodeJSä¹‹HTTPæ¨¡å—å­¦ä¹ ç¬”è®°</h1> <hr> <div data-v-34ea29db><i class="iconfont reco-account" data-v-34ea29db><span data-v-34ea29db>ç§¦æ˜Šjoyc</span></i> <i class="iconfont reco-date" data-v-34ea29db><span data-v-34ea29db>2019-08-02</span></i> <!----> <i class="iconfont reco-tag tags" data-v-34ea29db><span class="tag-item" data-v-34ea29db>Node</span><span class="tag-item" data-v-34ea29db>JS</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><h1 id="nodejsä¹‹httpæ¨¡å—å­¦ä¹ ç¬”è®°"><a href="#nodejsä¹‹httpæ¨¡å—å­¦ä¹ ç¬”è®°" class="header-anchor">ğŸŒ™</a> NodeJSä¹‹HTTPæ¨¡å—å­¦ä¹ ç¬”è®°</h1> <p><img src="E:%5Cblog%5Cimages%5Cnode%5Chttp-module.png" alt="HTTPæ¨¡å—"></p> <h2 id="_1-ç®€ä»‹"><a href="#_1-ç®€ä»‹" class="header-anchor">ğŸŒ™</a> 1.ç®€ä»‹</h2> <p>NodeJS ä¸­çš„ HTTP æ¥å£æ—¨åœ¨æ”¯æŒä¼ ç»Ÿä¸Šéš¾ä»¥ä½¿ç”¨çš„åè®®çš„è®¸å¤šç‰¹æ€§ã€‚ ç‰¹åˆ«æ˜¯ï¼Œå¤§å—çš„ã€å¯èƒ½å—ç¼–ç çš„æ¶ˆæ¯ã€‚ æ¥å£æ°¸è¿œä¸ä¼šç¼“å†²æ•´ä¸ªè¯·æ±‚æˆ–å“åº”ï¼Œæ‰€ä»¥ç”¨æˆ·èƒ½å¤Ÿ<strong>æµå¼ä¼ è¾“</strong>æ•°æ®ã€‚--- æ‘˜è‡ªå®˜ç½‘<a href="http://nodejs.cn/api/http.html" target="_blank" rel="noopener noreferrer">httpï¼ˆHTTPï¼‰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="_1-ä½¿ç”¨æ–¹å¼"><a href="#_1-ä½¿ç”¨æ–¹å¼" class="header-anchor">ğŸŒ™</a> 1.ä½¿ç”¨æ–¹å¼</h2> <p>è¦ä½¿ç”¨ HTTP æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ï¼Œå¿…é¡» <code>require('http')</code>ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ä¸éœ€è¦å®ä¾‹åŒ–,ç›´æ¥ä½¿ç”¨</span>
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_2-ä»module-exportsè¯´èµ·"><a href="#_2-ä»module-exportsè¯´èµ·" class="header-anchor">ğŸŒ™</a> 2.ä»module.exportsè¯´èµ·</h2> <p>æŸ¥çœ‹httpæ¨¡å—æºç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">METHODS</span><span class="token operator">:</span> methods<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// HTTPæ–¹æ³•</span>
  <span class="token constant">STATUS_CODES</span><span class="token punctuation">,</span> <span class="token comment">// æ ‡å‡† HTTP å“åº”çŠ¶æ€ç </span>
  Agent<span class="token operator">:</span> httpAgent<span class="token punctuation">.</span>Agent<span class="token punctuation">,</span> <span class="token comment">// ç®¡ç† HTTP å®¢æˆ·ç«¯çš„è¿æ¥æŒä¹…æ€§å’Œé‡ç”¨</span>
  ClientRequest<span class="token punctuation">,</span> <span class="token comment">// è¯·æ±‚ç±»</span>
  IncomingMessage<span class="token punctuation">,</span> <span class="token comment">// è®¿é—®å“åº”çŠ¶æ€ã€æ¶ˆæ¯å¤´ã€ä»¥åŠæ•°æ®</span>
  OutgoingMessage<span class="token punctuation">,</span>
  Server<span class="token punctuation">,</span> <span class="token comment">// æœåŠ¡</span>
  ServerResponse<span class="token punctuation">,</span> <span class="token comment">// å“åº”ç±»</span>
  createServer<span class="token punctuation">,</span> <span class="token comment">// åˆ›å»ºæœåŠ¡ new Server</span>
  <span class="token keyword">get</span><span class="token punctuation">,</span> <span class="token comment">// åˆ›å»ºgetè¯·æ±‚api</span>
  request <span class="token comment">// åˆ›å»ºå„ç§httpè¯·æ±‚api</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œhttpæ¨¡å—é»˜è®¤å°†å„ç§æ–¹æ³•å¯¼å‡ºï¼Œå®ƒæ²¡æœ‰å®šä¹‰ä¸€ä¸ªç»Ÿä¸€çš„æ„é€ æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡<code>http.createServer</code>è¿™ç§æ–¹å¼è°ƒç”¨ã€‚</p> <h2 id="_3-http-methods"><a href="#_3-http-methods" class="header-anchor">ğŸŒ™</a> 3.http.METHODS</h2> <p>è¿”å›ç±»å‹ï¼š<code>&lt;string[]&gt;</code></p> <p>è§£æå™¨æ”¯æŒçš„ HTTP æ–¹æ³•åˆ—è¡¨ï¼Œä¾èµ–äº<code>_http_common</code>æ¨¡å—ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> methods <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'_http_common'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token constant">METHODS</span><span class="token operator">:</span> methods<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™é‡Œ<code>http.METHODS</code>å¯¹<code>_http_common</code>æ¨¡å—ä¸­çš„<code>methods</code>åšäº†ä¸€ä¸ªæµ…æ‹·è´å¹¶æ’åºã€‚</p> <h2 id="_4-http-status-codes"><a href="#_4-http-status-codes" class="header-anchor">ğŸŒ™</a> 4.http.STATUS_CODES</h2> <p>è¿”å›ç±»å‹ï¼š<code>&lt;Object&gt;</code></p> <p>æ‰€æœ‰æ ‡å‡† HTTP å“åº”çŠ¶æ€ç çš„é›†åˆï¼Œä»¥åŠæ¯ä¸ªçŠ¶æ€ç çš„ç®€çŸ­æè¿°ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">STATUS_CODES</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token number">100</span><span class="token operator">:</span> <span class="token string">'Continue'</span><span class="token punctuation">,</span>
  <span class="token number">101</span><span class="token operator">:</span> <span class="token string">'Switching Protocols'</span><span class="token punctuation">,</span>
  <span class="token number">102</span><span class="token operator">:</span> <span class="token string">'Processing'</span><span class="token punctuation">,</span>                 <span class="token comment">// RFC 2518, obsoleted by RFC 4918</span>
  <span class="token number">103</span><span class="token operator">:</span> <span class="token string">'Early Hints'</span><span class="token punctuation">,</span>
  <span class="token number">200</span><span class="token operator">:</span> <span class="token string">'OK'</span><span class="token punctuation">,</span>
  <span class="token number">201</span><span class="token operator">:</span> <span class="token string">'Created'</span><span class="token punctuation">,</span>
  <span class="token number">202</span><span class="token operator">:</span> <span class="token string">'Accepted'</span><span class="token punctuation">,</span>
  <span class="token number">203</span><span class="token operator">:</span> <span class="token string">'Non-Authoritative Information'</span><span class="token punctuation">,</span>
  <span class="token number">204</span><span class="token operator">:</span> <span class="token string">'No Content'</span><span class="token punctuation">,</span>
  <span class="token number">205</span><span class="token operator">:</span> <span class="token string">'Reset Content'</span><span class="token punctuation">,</span>
  <span class="token number">206</span><span class="token operator">:</span> <span class="token string">'Partial Content'</span><span class="token punctuation">,</span>
  <span class="token number">207</span><span class="token operator">:</span> <span class="token string">'Multi-Status'</span><span class="token punctuation">,</span>               <span class="token comment">// RFC 4918</span>
  <span class="token number">208</span><span class="token operator">:</span> <span class="token string">'Already Reported'</span><span class="token punctuation">,</span>
  <span class="token number">226</span><span class="token operator">:</span> <span class="token string">'IM Used'</span><span class="token punctuation">,</span>
  <span class="token number">300</span><span class="token operator">:</span> <span class="token string">'Multiple Choices'</span><span class="token punctuation">,</span>           <span class="token comment">// RFC 7231</span>
  <span class="token number">301</span><span class="token operator">:</span> <span class="token string">'Moved Permanently'</span><span class="token punctuation">,</span>
  <span class="token number">302</span><span class="token operator">:</span> <span class="token string">'Found'</span><span class="token punctuation">,</span>
  <span class="token number">303</span><span class="token operator">:</span> <span class="token string">'See Other'</span><span class="token punctuation">,</span>
  <span class="token number">304</span><span class="token operator">:</span> <span class="token string">'Not Modified'</span><span class="token punctuation">,</span>
  <span class="token number">305</span><span class="token operator">:</span> <span class="token string">'Use Proxy'</span><span class="token punctuation">,</span>
  <span class="token number">307</span><span class="token operator">:</span> <span class="token string">'Temporary Redirect'</span><span class="token punctuation">,</span>
  <span class="token number">308</span><span class="token operator">:</span> <span class="token string">'Permanent Redirect'</span><span class="token punctuation">,</span>         <span class="token comment">// RFC 7238</span>
  <span class="token number">400</span><span class="token operator">:</span> <span class="token string">'Bad Request'</span><span class="token punctuation">,</span>
  <span class="token number">401</span><span class="token operator">:</span> <span class="token string">'Unauthorized'</span><span class="token punctuation">,</span>
  <span class="token number">402</span><span class="token operator">:</span> <span class="token string">'Payment Required'</span><span class="token punctuation">,</span>
  <span class="token number">403</span><span class="token operator">:</span> <span class="token string">'Forbidden'</span><span class="token punctuation">,</span>
  <span class="token number">404</span><span class="token operator">:</span> <span class="token string">'Not Found'</span><span class="token punctuation">,</span>
  <span class="token number">405</span><span class="token operator">:</span> <span class="token string">'Method Not Allowed'</span><span class="token punctuation">,</span>
  <span class="token number">406</span><span class="token operator">:</span> <span class="token string">'Not Acceptable'</span><span class="token punctuation">,</span>
  <span class="token number">407</span><span class="token operator">:</span> <span class="token string">'Proxy Authentication Required'</span><span class="token punctuation">,</span>
  <span class="token number">408</span><span class="token operator">:</span> <span class="token string">'Request Timeout'</span><span class="token punctuation">,</span>
  <span class="token number">409</span><span class="token operator">:</span> <span class="token string">'Conflict'</span><span class="token punctuation">,</span>
  <span class="token number">410</span><span class="token operator">:</span> <span class="token string">'Gone'</span><span class="token punctuation">,</span>
  <span class="token number">411</span><span class="token operator">:</span> <span class="token string">'Length Required'</span><span class="token punctuation">,</span>
  <span class="token number">412</span><span class="token operator">:</span> <span class="token string">'Precondition Failed'</span><span class="token punctuation">,</span>
  <span class="token number">413</span><span class="token operator">:</span> <span class="token string">'Payload Too Large'</span><span class="token punctuation">,</span>
  <span class="token number">414</span><span class="token operator">:</span> <span class="token string">'URI Too Long'</span><span class="token punctuation">,</span>
  <span class="token number">415</span><span class="token operator">:</span> <span class="token string">'Unsupported Media Type'</span><span class="token punctuation">,</span>
  <span class="token number">416</span><span class="token operator">:</span> <span class="token string">'Range Not Satisfiable'</span><span class="token punctuation">,</span>
  <span class="token number">417</span><span class="token operator">:</span> <span class="token string">'Expectation Failed'</span><span class="token punctuation">,</span>
  <span class="token number">418</span><span class="token operator">:</span> <span class="token string">'I\'m a Teapot'</span><span class="token punctuation">,</span>              <span class="token comment">// RFC 7168</span>
  <span class="token number">421</span><span class="token operator">:</span> <span class="token string">'Misdirected Request'</span><span class="token punctuation">,</span>
  <span class="token number">422</span><span class="token operator">:</span> <span class="token string">'Unprocessable Entity'</span><span class="token punctuation">,</span>       <span class="token comment">// RFC 4918</span>
  <span class="token number">423</span><span class="token operator">:</span> <span class="token string">'Locked'</span><span class="token punctuation">,</span>                     <span class="token comment">// RFC 4918</span>
  <span class="token number">424</span><span class="token operator">:</span> <span class="token string">'Failed Dependency'</span><span class="token punctuation">,</span>          <span class="token comment">// RFC 4918</span>
  <span class="token number">425</span><span class="token operator">:</span> <span class="token string">'Unordered Collection'</span><span class="token punctuation">,</span>       <span class="token comment">// RFC 4918</span>
  <span class="token number">426</span><span class="token operator">:</span> <span class="token string">'Upgrade Required'</span><span class="token punctuation">,</span>           <span class="token comment">// RFC 2817</span>
  <span class="token number">428</span><span class="token operator">:</span> <span class="token string">'Precondition Required'</span><span class="token punctuation">,</span>      <span class="token comment">// RFC 6585</span>
  <span class="token number">429</span><span class="token operator">:</span> <span class="token string">'Too Many Requests'</span><span class="token punctuation">,</span>          <span class="token comment">// RFC 6585</span>
  <span class="token number">431</span><span class="token operator">:</span> <span class="token string">'Request Header Fields Too Large'</span><span class="token punctuation">,</span> <span class="token comment">// RFC 6585</span>
  <span class="token number">451</span><span class="token operator">:</span> <span class="token string">'Unavailable For Legal Reasons'</span><span class="token punctuation">,</span>
  <span class="token number">500</span><span class="token operator">:</span> <span class="token string">'Internal Server Error'</span><span class="token punctuation">,</span>
  <span class="token number">501</span><span class="token operator">:</span> <span class="token string">'Not Implemented'</span><span class="token punctuation">,</span>
  <span class="token number">502</span><span class="token operator">:</span> <span class="token string">'Bad Gateway'</span><span class="token punctuation">,</span>
  <span class="token number">503</span><span class="token operator">:</span> <span class="token string">'Service Unavailable'</span><span class="token punctuation">,</span>
  <span class="token number">504</span><span class="token operator">:</span> <span class="token string">'Gateway Timeout'</span><span class="token punctuation">,</span>
  <span class="token number">505</span><span class="token operator">:</span> <span class="token string">'HTTP Version Not Supported'</span><span class="token punctuation">,</span>
  <span class="token number">506</span><span class="token operator">:</span> <span class="token string">'Variant Also Negotiates'</span><span class="token punctuation">,</span>    <span class="token comment">// RFC 2295</span>
  <span class="token number">507</span><span class="token operator">:</span> <span class="token string">'Insufficient Storage'</span><span class="token punctuation">,</span>       <span class="token comment">// RFC 4918</span>
  <span class="token number">508</span><span class="token operator">:</span> <span class="token string">'Loop Detected'</span><span class="token punctuation">,</span>
  <span class="token number">509</span><span class="token operator">:</span> <span class="token string">'Bandwidth Limit Exceeded'</span><span class="token punctuation">,</span>
  <span class="token number">510</span><span class="token operator">:</span> <span class="token string">'Not Extended'</span><span class="token punctuation">,</span>               <span class="token comment">// RFC 2774</span>
  <span class="token number">511</span><span class="token operator">:</span> <span class="token string">'Network Authentication Required'</span> <span class="token comment">// RFC 6585</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_5-http-createserveræ–¹æ³•"><a href="#_5-http-createserveræ–¹æ³•" class="header-anchor">ğŸŒ™</a> 5.http.createServeræ–¹æ³•</h2> <ul><li><code>options</code> <a href="http://nodejs.cn/s/jzn6Ao" target="_blank" rel="noopener noreferrer"><Object><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Object></a> <ul><li><code>IncomingMessage</code> <a href="http://nodejs.cn/s/2RqpEw" target="_blank" rel="noopener noreferrer">&lt;http.IncomingMessage&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æŒ‡å®šè¦ä½¿ç”¨çš„ <code>IncomingMessage</code> ç±»ã€‚ç”¨äºæ‰©å±•åŸå§‹çš„ <code>IncomingMessage</code>ã€‚<strong>é»˜è®¤å€¼:</strong> <code>IncomingMessage</code>ã€‚</li> <li><code>ServerResponse</code> <a href="http://nodejs.cn/s/rMXoZ1" target="_blank" rel="noopener noreferrer">&lt;http.ServerResponse&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æŒ‡å®šè¦ä½¿ç”¨çš„ <code>ServerResponse</code> ç±»ã€‚ç”¨äºæ‰©å±•åŸå§‹çš„ <code>ServerResponse</code>ã€‚<strong>é»˜è®¤å€¼:</strong> <code>ServerResponse</code>ã€‚</li> <li><code>insecureHTTPParser</code> <a href="http://nodejs.cn/s/jFbvuT" target="_blank" rel="noopener noreferrer"><boolean><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></boolean></a> ä½¿ç”¨ä¸å®‰å…¨çš„ HTTP è§£æå™¨ï¼Œå½“ä¸º <code>true</code> æ—¶æ¥å—æ— æ•ˆçš„ HTTP è¯·æ±‚å¤´ã€‚åº”é¿å…ä½¿ç”¨ä¸å®‰å…¨çš„è§£æå™¨ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œå‚è§ <a href="http://nodejs.cn/s/5Bnm43" target="_blank" rel="noopener noreferrer"><code>--insecure-http-parser</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚<strong>é»˜è®¤å€¼:</strong> <code>false</code>ã€‚</li> <li><code>maxHeaderSize</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a> å¯é€‰åœ°ï¼Œé‡å†™æ­¤æœåŠ¡å™¨æ¥æ”¶çš„è¯·æ±‚çš„ <a href="http://nodejs.cn/s/HfsyuU" target="_blank" rel="noopener noreferrer"><code>--max-http-header-size</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å€¼ï¼Œå³è¯·æ±‚å¤´çš„æœ€å¤§é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚ <strong>é»˜è®¤å€¼:</strong> 16384ï¼ˆ16KBï¼‰ã€‚</li></ul></li> <li><code>requestListener</code> <a href="http://nodejs.cn/s/ceTQa6" target="_blank" rel="noopener noreferrer"><Function><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Function></a>ï¼Œ æ˜¯ä¸€ä¸ªè‡ªåŠ¨æ·»åŠ åˆ° <a href="http://nodejs.cn/s/2qCn57" target="_blank" rel="noopener noreferrer"><code>'request'</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> äº‹ä»¶çš„å‡½æ•°ã€‚å‚æ•°(request, response)è§åé¢çš„<code>http.clientRequest</code>å’Œ<code>http.ServerResponse</code>ã€‚</li> <li>è¿”å›: <a href="http://nodejs.cn/s/jLiRTh" target="_blank" rel="noopener noreferrer">&lt;http.Server&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>æºç è§£è¯»ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  Server<span class="token punctuation">,</span>
 	<span class="token operator">...</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'_http_server'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">createServer</span><span class="token punctuation">(</span><span class="token parameter">opts<span class="token punctuation">,</span> requestListener</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Server</span><span class="token punctuation">(</span>opts<span class="token punctuation">,</span> requestListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>Server</code>é€šè¿‡<code>http.createServer</code>æ¥å®ä¾‹åŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ›å»ºæœåŠ¡å™¨ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å®ä¾‹åŒ–</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">http<span class="token punctuation">.</span>Server</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_6-http-agentç±»"><a href="#_6-http-agentç±»" class="header-anchor">ğŸŒ™</a> 6.http.Agentç±»</h2> <p>ç®€ä»‹ï¼š<code>Agent</code> è´Ÿè´£ç®¡ç† HTTP å®¢æˆ·ç«¯çš„è¿æ¥æŒä¹…æ€§å’Œé‡ç”¨ã€‚å½“ä¸å†ä½¿ç”¨æ—¶æœ€å¥½ <a href="http://nodejs.cn/s/qZQu4q" target="_blank" rel="noopener noreferrer"><code>destroy()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <code>Agent</code> å®ä¾‹ï¼Œå› ä¸ºæœªä½¿ç”¨çš„<code>Socket</code>ä¼šæ¶ˆè€—æ“ä½œç³»ç»Ÿèµ„æºã€‚å‚è§å®˜ç½‘<a href="http://nodejs.cn/api/http.html#http_class_http_agent" target="_blank" rel="noopener noreferrer">http.Agent ç±»<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_6-1new-agent-options-æ„é€ æ–¹æ³•"><a href="#_6-1new-agent-options-æ„é€ æ–¹æ³•" class="header-anchor">ğŸŒ™</a> 6.1<code>new Agent([options])</code>æ„é€ æ–¹æ³•</h3> <p><code>options</code> <a href="http://nodejs.cn/s/jzn6Ao" target="_blank" rel="noopener noreferrer"><Object><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Object></a> è¦åœ¨ä»£ç†ä¸Šè®¾ç½®çš„å¯é…ç½®é€‰é¡¹é›†ï¼š</p> <ul><li><p><code>keepAlive &lt;boolean&gt;</code>ï¼Œ<strong>é»˜è®¤å€¼:</strong> <code>false</code>, true-å¼€å¯é•¿è¿æ¥ï¼›</p> <p>ä¸è¦ä¸ <code>Connection</code> è¯·æ±‚å¤´çš„ <code>keep-alive</code> å€¼æ··æ·†ã€‚ <code>Connection: keep-alive</code> è¯·æ±‚å¤´å§‹ç»ˆåœ¨ä½¿ç”¨ä»£ç†æ—¶å‘é€ï¼Œé™¤éæ˜ç¡®æŒ‡å®š <code>Connection</code> è¯·æ±‚å¤´ã€æˆ–è€… <code>keepAlive</code> å’Œ <code>maxSockets</code> é€‰é¡¹åˆ†åˆ«è®¾ç½®ä¸º <code>false</code> å’Œ <code>Infinity</code>ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹å°†ä¼šä½¿ç”¨ <code>Connection: close</code>ã€‚</p></li></ul> <blockquote><p><a href="https://my.oschina.net/antianlu/blog/261105" target="_blank" rel="noopener noreferrer">NodeJSå¦‚ä½•å®ç°çœŸæ­£çš„é•¿è¿æ¥ï¼Ÿ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://www.yuque.com/egg/nodejs/keep-alive-agent-econnreset" target="_blank" rel="noopener noreferrer">è§£å†³ä½¿ç”¨ KeepAlive Agent é‡åˆ°çš„ ECONNRESET<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <ul><li><p><code>keepAliveMsecs</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a> å½“ä½¿ç”¨ <code>keepAlive</code> é€‰é¡¹æ—¶ï¼ŒæŒ‡å®šç”¨äº TCP Keep-Alive æ•°æ®åŒ…çš„<a href="http://nodejs.cn/s/qqbgUD" target="_blank" rel="noopener noreferrer">åˆå§‹å»¶è¿Ÿ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚å½“ <code>keepAlive</code> é€‰é¡¹ä¸º <code>false</code> æˆ– <code>undefined</code> æ—¶åˆ™å¿½ç•¥ã€‚<strong>é»˜è®¤å€¼:</strong> <code>1000</code>ã€‚</p></li> <li><p><code>maxSockets</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a> æ¯ä¸ªä¸»æœºå…è®¸çš„<code>Socket</code>çš„æœ€å¤§æ•°é‡ã€‚<strong>é»˜è®¤å€¼:</strong> <code>Infinity</code>ã€‚</p></li> <li><p><code>maxFreeSockets</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer">number<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> åœ¨ç©ºé—²çŠ¶æ€ä¸‹ä¿æŒæ‰“å¼€çš„<code>Socket</code>çš„æœ€å¤§æ•°é‡ã€‚ä»…å½“ <code>keepAlive</code> è¢«è®¾ç½®ä¸º <code>true</code> æ—¶æ‰ç›¸å…³ã€‚<strong>é»˜è®¤å€¼:</strong> <code>256</code>ã€‚</p></li> <li><p><code>timeout</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a> <code>Socket</code>çš„è¶…æ—¶æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚è¿™ä¼šåœ¨<code>Socket</code>è¢«è¿æ¥ä¹‹åè®¾ç½®è¶…æ—¶æ—¶é—´ã€‚</p></li></ul> <p>è¦é…ç½®å…¶ä¸­ä»»ä½•ä¸€ä¸ªï¼Œåˆ™å¿…é¡»åˆ›å»ºè‡ªå®šä¹‰çš„ <a href="http://nodejs.cn/s/HRCnER" target="_blank" rel="noopener noreferrer"><code>http.Agent</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å®ä¾‹:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> keepAliveAgent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">http<span class="token punctuation">.</span>Agent</span><span class="token punctuation">(</span><span class="token punctuation">{</span> keepAlive<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
options<span class="token punctuation">.</span>agent <span class="token operator">=</span> keepAliveAgent<span class="token punctuation">;</span>
http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> onResponseCallback<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_6-2-agent-createconnection-options-callback"><a href="#_6-2-agent-createconnection-options-callback" class="header-anchor">ğŸŒ™</a> 6.2 <code>agent.createConnection(options[, callback])</code></h3> <p>ç”Ÿæˆç”¨äº HTTP è¯·æ±‚çš„<code>Socket</code>æˆ–æµã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­¤å‡½æ•°ä¸ <a href="http://nodejs.cn/s/xu7F69" target="_blank" rel="noopener noreferrer"><code>net.createConnection()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ç›¸åŒã€‚</p> <ul><li><code>options</code> <a href="http://nodejs.cn/s/jzn6Ao" target="_blank" rel="noopener noreferrer"><Object><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Object></a> åŒ…å«è¿æ¥è¯¦ç»†ä¿¡æ¯çš„é€‰é¡¹ã€‚ æŸ¥çœ‹ <a href="http://nodejs.cn/s/xu7F69" target="_blank" rel="noopener noreferrer"><code>net.createConnection()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä»¥è·å–é€‰é¡¹çš„æ ¼å¼ã€‚</li> <li><code>callback</code> <a href="http://nodejs.cn/s/ceTQa6" target="_blank" rel="noopener noreferrer"><Function><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Function></a> æ¥æ”¶åˆ›å»ºçš„<code>Socket</code>çš„å›è°ƒå‡½æ•°ã€‚</li> <li>è¿”å›: <a href="http://nodejs.cn/s/2iRabr" target="_blank" rel="noopener noreferrer">&lt;stream.Duplex&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="_6-3-agent-keepsocketalive-socket"><a href="#_6-3-agent-keepsocketalive-socket" class="header-anchor">ğŸŒ™</a> 6.3 <code>agent.keepSocketAlive(socket)</code></h3> <p><code>socket</code> <a href="http://nodejs.cn/s/2iRabr" target="_blank" rel="noopener noreferrer">&lt;stream.Duplex&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>å½“ <code>socket</code> ä¸è¯·æ±‚åˆ†ç¦»å¹¶ä¸”å¯ä»¥ç”± <code>Agent</code> ä¿ç•™æ—¶è°ƒç”¨ã€‚ é»˜è®¤è¡Œä¸ºæ˜¯ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>socket<span class="token punctuation">.</span><span class="token function">setKeepAlive</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>keepAliveMsecs<span class="token punctuation">)</span><span class="token punctuation">;</span>
socket<span class="token punctuation">.</span><span class="token function">unref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre></div><p>æ­¤æ–¹æ³•å¯ä»¥ç”±ç‰¹å®šçš„ <code>Agent</code> å­ç±»é‡å†™ã€‚</p> <h3 id="_6-4-agent-reusesocket-socket-request"><a href="#_6-4-agent-reusesocket-socket-request" class="header-anchor">ğŸŒ™</a> 6.4 <code>agent.reuseSocket(socket, request)</code></h3> <ul><li><code>socket</code> <a href="http://nodejs.cn/s/2iRabr" target="_blank" rel="noopener noreferrer">&lt;stream.Duplex&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><code>request</code> <a href="http://nodejs.cn/s/2F5RHd" target="_blank" rel="noopener noreferrer">&lt;http.ClientRequest&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>ç”±äº keep-alive é€‰é¡¹è€Œåœ¨æŒä¹…åŒ–åå°† <code>socket</code> é™„åŠ åˆ° <code>request</code> æ—¶è°ƒç”¨ã€‚ é»˜è®¤è¡Œä¸ºæ˜¯ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>socket<span class="token punctuation">.</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æ­¤æ–¹æ³•å¯ä»¥ç”±ç‰¹å®šçš„ <code>Agent</code> å­ç±»é‡å†™ã€‚</p> <h3 id="_6-5-agent-destroy"><a href="#_6-5-agent-destroy" class="header-anchor">ğŸŒ™</a> 6.5 <code>agent.destroy()</code></h3> <p>é”€æ¯ä»£ç†å½“å‰ä½¿ç”¨çš„æ‰€æœ‰<code>Socket</code>ã€‚</p> <p>é€šå¸¸æ²¡æœ‰å¿…è¦è¿™æ ·åšã€‚ ä½†æ˜¯ï¼Œå¦‚æœä½¿ç”¨å¯ç”¨äº† <code>keepAlive</code> çš„ä»£ç†ï¼Œåˆ™æœ€å¥½åœ¨ä»£ç†ä¸å†ä½¿ç”¨æ—¶æ˜¾å¼å…³é—­ä»£ç†ã€‚ å¦åˆ™ï¼Œåœ¨æœåŠ¡å™¨ç»ˆæ­¢<code>Socket</code>ä¹‹å‰ï¼Œ<code>Socket</code>å¯èƒ½ä¼šæŒ‚èµ·å¾ˆé•¿æ—¶é—´ã€‚</p> <h3 id="_6-6-agent-freesockets"><a href="#_6-6-agent-freesockets" class="header-anchor">ğŸŒ™</a> 6.6 <code>agent.freeSockets</code></h3> <p><a href="http://nodejs.cn/s/jzn6Ao" target="_blank" rel="noopener noreferrer"><Object><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Object></a></p> <p>ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«å½“å¯ç”¨ <code>keepAlive</code> æ—¶ä»£ç†æ­£åœ¨ç­‰å¾…ä½¿ç”¨çš„<code>Socket</code>æ•°ç»„ã€‚ ä¸è¦ä¿®æ”¹ã€‚</p> <p><code>freeSockets</code> åˆ—è¡¨ä¸­çš„ socket ä¼šåœ¨ `'timeout' æ—¶è‡ªåŠ¨è¢«é”€æ¯å¹¶ä»æ•°ç»„ä¸­åˆ é™¤ã€‚</p> <h3 id="_6-7-agent-getname-options"><a href="#_6-7-agent-getname-options" class="header-anchor">ğŸŒ™</a> 6.7  <code>agent.getName(options)</code></h3> <ul><li><code>options</code> <a href="http://nodejs.cn/s/jzn6Ao" target="_blank" rel="noopener noreferrer"><Object><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Object></a> ä¸€ç»„é€‰é¡¹ï¼Œä¸ºç”Ÿæˆåç§°æä¾›ä¿¡æ¯ã€‚
<ul><li><code>host</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> è¯·æ±‚å‘é€è‡³çš„æœåŠ¡å™¨çš„åŸŸåæˆ– IP åœ°å€ã€‚</li> <li><code>port</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a> è¿œç¨‹æœåŠ¡å™¨çš„ç«¯å£ã€‚</li> <li><code>localAddress</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> ä¸ºç½‘ç»œè¿æ¥ç»‘å®šçš„æœ¬åœ°æ¥å£ã€‚</li> <li><code>family</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><integer><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></integer></a> å¦‚æœä¸ç­‰äº <code>undefined</code>ï¼Œåˆ™å¿…é¡»ä¸º 4 æˆ– 6ã€‚</li></ul></li> <li>è¿”å›: <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a></li></ul> <p>è·å–ä¸€ç»„è¯·æ±‚é€‰é¡¹çš„å”¯ä¸€åç§°ï¼Œä»¥åˆ¤å®šä¸€ä¸ªè¿æ¥æ˜¯å¦å¯ä»¥è¢«é‡ç”¨ã€‚ å¯¹äº HTTP ä»£ç†ï¼Œè¿™è¿”å› <code>host:port:localAddress</code> æˆ– <code>host:port:localAddress:family</code>ã€‚ å¯¹äº HTTPS ä»£ç†ï¼Œè¯¥åç§°åŒ…æ‹¬ CAã€è¯ä¹¦ã€å¯†ç ã€ä»¥åŠå…¶ä»–å¯åˆ¤å®š<code>Socket</code>å¯é‡ç”¨æ€§çš„ HTTPS/TLS ç‰¹æœ‰çš„é€‰é¡¹ã€‚</p> <h3 id="_6-8-agent-maxfreesockets"><a href="#_6-8-agent-maxfreesockets" class="header-anchor">ğŸŒ™</a> 6.8 <code>agent.maxFreeSockets</code></h3> <ul><li><a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a></li></ul> <p>é»˜è®¤è®¾ç½®ä¸º 256ã€‚ å¯¹äºå¯ç”¨äº† <code>keepAlive</code> çš„ä»£ç†ï¼Œè¿™å°†è®¾ç½®åœ¨ç©ºé—²çŠ¶æ€ä¸‹ä¿æŒæ‰“å¼€çš„æœ€å¤§<code>Socket</code>æ•°ã€‚</p> <h3 id="_6-9-agent-requests"><a href="#_6-9-agent-requests" class="header-anchor">ğŸŒ™</a> 6.9 <code>agent.requests</code></h3> <ul><li><a href="http://nodejs.cn/s/jzn6Ao" target="_blank" rel="noopener noreferrer"><Object><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Object></a></li></ul> <p>ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«å°šæœªåˆ†é…ç»™<code>Socket</code>çš„è¯·æ±‚é˜Ÿåˆ—ã€‚ ä¸è¦ä¿®æ”¹ã€‚</p> <h3 id="_6-10-agent-sockets"><a href="#_6-10-agent-sockets" class="header-anchor">ğŸŒ™</a> 6.10 <code>agent.sockets</code></h3> <ul><li><Object>](http://nodejs.cn/s/jzn6Ao)
</Object></li></ul> <p>ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«å°šæœªåˆ†é…ç»™<code>Socket</code>çš„è¯·æ±‚é˜Ÿåˆ—ã€‚ ä¸è¦ä¿®æ”¹ã€‚</p> <h2 id="_7-http-clientrequestç±»"><a href="#_7-http-clientrequestç±»" class="header-anchor">ğŸŒ™</a> 7.http.ClientRequestç±»</h2> <p>ç»§æ‰¿è‡ª: <a href="http://nodejs.cn/s/t73H94" target="_blank" rel="noopener noreferrer"><Stream><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Stream></a></p> <p>æºç è§£è¯»ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> options<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ClientRequest</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> options<span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ­¤å¯¹è±¡ç”± <a href="http://nodejs.cn/s/d1myoL" target="_blank" rel="noopener noreferrer"><code>http.request()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å†…éƒ¨åˆ›å»ºå¹¶è¿”å›ã€‚ å®ƒä»£è¡¨æ­£åœ¨è¿›è¡Œä¸­çš„è¯·æ±‚ï¼Œå…¶è¯·æ±‚å¤´å·²è¿›å…¥é˜Ÿåˆ—ã€‚ è¯·æ±‚å¤´ä»ç„¶å¯ä»¥ä½¿ç”¨ <a href="http://nodejs.cn/s/ZBShBB" target="_blank" rel="noopener noreferrer"><code>setHeader(name, value)</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€<a href="http://nodejs.cn/s/noVJNv" target="_blank" rel="noopener noreferrer"><code>getHeader(name)</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æˆ– <a href="http://nodejs.cn/s/vzuErq" target="_blank" rel="noopener noreferrer"><code>removeHeader(name)</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> API è¿›è¡Œæ”¹å˜ã€‚ å®é™…çš„è¯·æ±‚å¤´å°†ä¼šä¸ç¬¬ä¸€ä¸ªæ•°æ®å—ä¸€èµ·å‘é€ï¼Œæˆ–è€…å½“è°ƒç”¨ <a href="http://nodejs.cn/s/GAdV2u" target="_blank" rel="noopener noreferrer"><code>request.end()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ—¶å‘é€ã€‚</p> <p>è¦è·å¾—å“åº”ï¼Œåˆ™ä¸ºè¯·æ±‚å¯¹è±¡æ·»åŠ  <a href="http://nodejs.cn/s/qwaiK8" target="_blank" rel="noopener noreferrer"><code>'response'</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> äº‹ä»¶ç›‘å¬å™¨ã€‚ å½“æ¥æ”¶åˆ°å“åº”å¤´æ—¶ï¼Œä¼šä»è¯·æ±‚å¯¹è±¡ä¸­è§¦å‘ <a href="http://nodejs.cn/s/qwaiK8" target="_blank" rel="noopener noreferrer"><code>'response'</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> äº‹ä»¶ã€‚ <a href="http://nodejs.cn/s/qwaiK8" target="_blank" rel="noopener noreferrer"><code>'response'</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> äº‹ä»¶æ‰§è¡Œæ—¶å…·æœ‰ä¸€ä¸ªå‚æ•°ï¼Œè¯¥å‚æ•°æ˜¯ <a href="http://nodejs.cn/s/2RqpEw" target="_blank" rel="noopener noreferrer"><code>http.IncomingMessage</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„å®ä¾‹ã€‚</p> <p>åœ¨ <a href="http://nodejs.cn/s/qwaiK8" target="_blank" rel="noopener noreferrer"><code>'response'</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> äº‹ä»¶æœŸé—´ï¼Œå¯ä»¥æ·»åŠ ç›‘å¬å™¨åˆ°å“åº”å¯¹è±¡ï¼Œæ¯”å¦‚ç›‘å¬ <code>'data'</code> äº‹ä»¶ã€‚</p> <p>å¦‚æœæ²¡æœ‰æ·»åŠ  <a href="http://nodejs.cn/s/qwaiK8" target="_blank" rel="noopener noreferrer"><code>'response'</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œåˆ™å“åº”å°†ä¼šè¢«å®Œå…¨åœ°ä¸¢å¼ƒã€‚ å¦‚æœæ·»åŠ äº† <a href="http://nodejs.cn/s/qwaiK8" target="_blank" rel="noopener noreferrer"><code>'response'</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œåˆ™å¿…é¡»æ¶ˆè´¹å®Œå“åº”å¯¹è±¡ä¸­çš„æ•°æ®ï¼Œæ¯å½“æœ‰ <code>'readable'</code> äº‹ä»¶æ—¶è°ƒç”¨ <code>response.read()</code>ã€æˆ–æ·»åŠ  <code>'data'</code> äº‹ä»¶å¤„ç†å‡½æ•°ã€æˆ–é€šè¿‡è°ƒç”¨ <code>.resume()</code> æ–¹æ³•ã€‚ åœ¨æ¶ˆè´¹å®Œæ•°æ®ä¹‹å‰ï¼Œä¸ä¼šè§¦å‘ <code>'end'</code> äº‹ä»¶ã€‚ æ­¤å¤–ï¼Œåœ¨è¯»å–æ•°æ®ä¹‹å‰ï¼Œå®ƒå°†ä¼šå ç”¨å†…å­˜ï¼Œè¿™æœ€ç»ˆå¯èƒ½å¯¼è‡´è¿›ç¨‹å†…å­˜ä¸è¶³çš„é”™è¯¯ã€‚</p> <p>ä¸ <code>request</code> å¯¹è±¡ä¸åŒï¼Œå¦‚æœå“åº”è¿‡æ—©åœ°å…³é—­ï¼Œåˆ™ <code>response</code> å¯¹è±¡ä¸ä¼šè§¦å‘ <code>'error'</code> äº‹ä»¶è€Œæ˜¯è§¦å‘ <code>'aborted'</code> äº‹ä»¶ã€‚</p> <p>Node.js ä¸ä¼šæ£€æŸ¥ Content-Length å’Œå·²ä¼ è¾“çš„è¯·æ±‚ä½“çš„é•¿åº¦æ˜¯å¦ç›¸ç­‰ã€‚</p> <h3 id="_7-1-http-clientrequestäº‹ä»¶ç›‘å¬"><a href="#_7-1-http-clientrequestäº‹ä»¶ç›‘å¬" class="header-anchor">ğŸŒ™</a> 7.1 http.ClientRequestäº‹ä»¶ç›‘å¬</h3> <h4 id="_7-1-1-abort-äº‹ä»¶"><a href="#_7-1-1-abort-äº‹ä»¶" class="header-anchor">ğŸŒ™</a> 7.1.1 'abort' äº‹ä»¶</h4> <p>å½“è¯·æ±‚è¢«å®¢æˆ·ç«¯ä¸­æ­¢æ—¶è§¦å‘ã€‚ æ­¤äº‹ä»¶ä»…åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨ <code>abort()</code> æ—¶è§¦å‘ã€‚</p> <h4 id="_7-1-2-connect-äº‹ä»¶"><a href="#_7-1-2-connect-äº‹ä»¶" class="header-anchor">ğŸŒ™</a> 7.1.2 'connect' äº‹ä»¶</h4> <ul><li><code>response</code> <a href="http://nodejs.cn/s/2RqpEw" target="_blank" rel="noopener noreferrer">httpIncomingMessage<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><code>socket</code> <a href="http://nodejs.cn/s/2iRabr" target="_blank" rel="noopener noreferrer">stream.Duplex<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><code>head</code> <a href="http://nodejs.cn/s/6x1hD3" target="_blank" rel="noopener noreferrer">Buffer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>æ¯æ¬¡æœåŠ¡å™¨ä½¿ç”¨ <code>CONNECT</code> æ–¹æ³•å“åº”è¯·æ±‚æ—¶éƒ½ä¼šè§¦å‘ã€‚ å¦‚æœæœªç›‘å¬æ­¤äº‹ä»¶ï¼Œåˆ™æ¥æ”¶ <code>CONNECT</code> æ–¹æ³•çš„å®¢æˆ·ç«¯å°†å…³é—­å…¶è¿æ¥ã€‚</p> <p>æ­¤äº‹ä»¶ä¿è¯ä¼ å…¥ <a href="http://nodejs.cn/s/wsJ1o1" target="_blank" rel="noopener noreferrer">net.Socket<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ç±»ï¼ˆ<a href="http://nodejs.cn/s/2iRabr" target="_blank" rel="noopener noreferrer">stream.Duplex<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„å­ç±»ï¼‰çš„å®ä¾‹ï¼Œé™¤éç”¨æˆ·æŒ‡å®šäº† <a href="http://nodejs.cn/s/wsJ1o1" target="_blank" rel="noopener noreferrer">net.Socket<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä»¥å¤–çš„<code>Socket</code>ç±»å‹ã€‚</p> <p>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¯¹æ¼”ç¤ºäº†å¦‚ä½•ç›‘å¬ <code>'connect'</code> äº‹ä»¶ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> net <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'net'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">URL</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ›å»º HTTP éš§é“ä»£ç†ã€‚</span>
<span class="token keyword">const</span> proxy <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/plain'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'å“åº”å†…å®¹'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
proxy<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connect'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> clientSocket<span class="token punctuation">,</span> head</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// è¿æ¥åˆ°åŸå§‹æœåŠ¡å™¨ã€‚</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> port<span class="token punctuation">,</span> hostname <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> serverSocket <span class="token operator">=</span> net<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>port <span class="token operator">||</span> <span class="token number">80</span><span class="token punctuation">,</span> hostname<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    clientSocket<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'HTTP/1.1 200 Connection Established\r\n'</span> <span class="token operator">+</span>
                    <span class="token string">'Proxy-agent: Node.js-Proxy\r\n'</span> <span class="token operator">+</span>
                    <span class="token string">'\r\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    serverSocket<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">;</span>
    serverSocket<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>clientSocket<span class="token punctuation">)</span><span class="token punctuation">;</span>
    clientSocket<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>serverSocket<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä»£ç†æ­£åœ¨è¿è¡Œã€‚</span>
proxy<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">1337</span><span class="token punctuation">,</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token comment">// å‘éš§é“ä»£ç†å‘å‡ºè¯·æ±‚ã€‚</span>
  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
    port<span class="token operator">:</span> <span class="token number">1337</span><span class="token punctuation">,</span>
    host<span class="token operator">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
    method<span class="token operator">:</span> <span class="token string">'CONNECT'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> <span class="token string">'nodejs.cn:80'</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> req <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  req<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connect'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> socket<span class="token punctuation">,</span> head</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å·²è¿æ¥'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// é€šè¿‡ HTTP éš§é“å‘å‡ºè¯·æ±‚ã€‚</span>
    socket<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'GET / HTTP/1.1\r\n'</span> <span class="token operator">+</span>
                 <span class="token string">'Host: nodejs.cn:80\r\n'</span> <span class="token operator">+</span>
                 <span class="token string">'Connection: close\r\n'</span> <span class="token operator">+</span>
                 <span class="token string">'\r\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chunk<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      proxy<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_7-1-3-continue-äº‹ä»¶"><a href="#_7-1-3-continue-äº‹ä»¶" class="header-anchor">ğŸŒ™</a> 7.1.3 'continue' äº‹ä»¶</h4> <p>å½“æœåŠ¡å™¨å‘é€ <code>100 Continue</code> HTTP å“åº”æ—¶è§¦å‘ï¼Œé€šå¸¸æ˜¯å› ä¸ºè¯·æ±‚åŒ…å« <code>Expect: 100-continue</code>ã€‚ è¿™æ˜¯å®¢æˆ·ç«¯åº”å‘é€è¯·æ±‚ä¸»ä½“çš„æŒ‡ä»¤ã€‚</p> <h4 id="_7-1-4-information-äº‹ä»¶"><a href="#_7-1-4-information-äº‹ä»¶" class="header-anchor">ğŸŒ™</a> 7.1.4 'information' äº‹ä»¶</h4> <p><code>info</code> <a href="http://nodejs.cn/s/jzn6Ao" target="_blank" rel="noopener noreferrer"><Object><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Object></a></p> <ul><li><code>httpVersion</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a></li> <li><code>httpVersionMajor</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><integer><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></integer></a></li> <li><code>httpVersionMinor</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><integer><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></integer></a></li> <li><code>statusCode</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><integer><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></integer></a></li> <li><code>statusMessage</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a></li> <li><code>headers</code> <a href="http://nodejs.cn/s/jzn6Ao" target="_blank" rel="noopener noreferrer"><Object><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Object></a></li> <li><code>rawHeaders</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer">&lt;string[]&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>æœåŠ¡å™¨å‘é€ 1xx ä¸­é—´å“åº”ï¼ˆä¸åŒ…æ‹¬ 101 Upgradeï¼‰æ—¶è§¦å‘ã€‚ æ­¤äº‹ä»¶çš„ç›‘å¬å™¨å°†ä¼šæ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å« HTTP ç‰ˆæœ¬ï¼ŒçŠ¶æ€ç ï¼ŒçŠ¶æ€æ¶ˆæ¯ï¼Œé”®å€¼å¯¹è¯·æ±‚å¤´å¯¹è±¡ã€ä»¥åŠå…·æœ‰åŸå§‹è¯·æ±‚å¤´åç§°å’Œå€¼çš„æ•°ç»„ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  host<span class="token operator">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
  port<span class="token operator">:</span> <span class="token number">8080</span><span class="token punctuation">,</span>
  path<span class="token operator">:</span> <span class="token string">'/length_request'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// å‘å‡ºè¯·æ±‚ã€‚</span>
<span class="token keyword">const</span> req <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
req<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'information'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">è·å¾—ä¸»å“åº”ä¹‹å‰çš„ä¿¡æ¯: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>info<span class="token punctuation">.</span>statusCode<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>101 Upgrade</code> çŠ¶æ€ä¸ä¼šè§¦å‘æ­¤äº‹ä»¶ï¼Œå› ä¸ºå®ƒä»¬ä¸ä¼ ç»Ÿçš„ HTTP è¯·æ±‚/å“åº”é“¾æ–­å¼€ï¼Œä¾‹å¦‚ Web <code>Socket</code>ã€ç°åœº TLS å‡çº§ã€æˆ– HTTP 2.0ã€‚ è¦æ”¶åˆ° <code>101 Upgrade</code> çš„é€šçŸ¥ï¼Œè¯·æ”¹ä¸ºç›‘å¬ <a href="http://nodejs.cn/s/xjUtig" target="_blank" rel="noopener noreferrer"><code>'upgrade'</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> äº‹ä»¶ã€‚</p> <h4 id="_7-1-5-response-äº‹ä»¶"><a href="#_7-1-5-response-äº‹ä»¶" class="header-anchor">ğŸŒ™</a> 7.1.5 'response' äº‹ä»¶</h4> <ul><li><code>response</code> <a href="http://nodejs.cn/s/2RqpEw" target="_blank" rel="noopener noreferrer">&lt;http.IncomingMessage&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>å½“æ”¶åˆ°æ­¤è¯·æ±‚çš„å“åº”æ—¶è§¦å‘ã€‚ æ­¤äº‹ä»¶ä»…è§¦å‘ä¸€æ¬¡ã€‚</p> <h4 id="_7-1-6-socket-äº‹ä»¶"><a href="#_7-1-6-socket-äº‹ä»¶" class="header-anchor">ğŸŒ™</a> 7.1.6 'socket' äº‹ä»¶</h4> <ul><li><code>socket</code> <a href="http://nodejs.cn/s/2iRabr" target="_blank" rel="noopener noreferrer">&lt;stream.Duplex&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>æ­¤äº‹ä»¶ä¿è¯ä¼ å…¥ <a href="http://nodejs.cn/s/wsJ1o1" target="_blank" rel="noopener noreferrer">&lt;net.Socket&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ç±»ï¼ˆ<a href="http://nodejs.cn/s/2iRabr" target="_blank" rel="noopener noreferrer">&lt;stream.Duplex&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„å­ç±»ï¼‰çš„å®ä¾‹ï¼Œé™¤éç”¨æˆ·æŒ‡å®šäº† <a href="http://nodejs.cn/s/wsJ1o1" target="_blank" rel="noopener noreferrer">&lt;net.Socket&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä»¥å¤–çš„<code>Socket</code>ç±»å‹ã€‚</p> <h4 id="_7-1-7-timeout-äº‹ä»¶"><a href="#_7-1-7-timeout-äº‹ä»¶" class="header-anchor">ğŸŒ™</a> 7.1.7 'timeout' äº‹ä»¶</h4> <p>å½“åº•å±‚<code>Socket</code>å› ä¸æ´»åŠ¨è€Œè¶…æ—¶æ—¶è§¦å‘ã€‚ è¿™åªä¼šé€šçŸ¥<code>Socket</code>å·²ç©ºé—²ã€‚ å¿…é¡»æ‰‹åŠ¨ä¸­æ­¢è¯·æ±‚ã€‚</p> <p>å¦è¯·å‚è§ï¼š<a href="http://nodejs.cn/s/qX7N7E" target="_blank" rel="noopener noreferrer"><code>request.setTimeout()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <h4 id="_7-1-8-upgrade-äº‹ä»¶"><a href="#_7-1-8-upgrade-äº‹ä»¶" class="header-anchor">ğŸŒ™</a> 7.1.8 'upgrade' äº‹ä»¶</h4> <ul><li><code>response</code> <a href="http://nodejs.cn/s/2RqpEw" target="_blank" rel="noopener noreferrer">&lt;http.IncomingMessage&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><code>socket</code> <a href="http://nodejs.cn/s/2iRabr" target="_blank" rel="noopener noreferrer">&lt;stream.Duplex&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><code>head</code> <a href="http://nodejs.cn/s/6x1hD3" target="_blank" rel="noopener noreferrer"><Buffer><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Buffer></a></li></ul> <p>æ¯æ¬¡æœåŠ¡å™¨å“åº”å‡çº§è¯·æ±‚æ—¶å‘å‡ºã€‚ å¦‚æœæœªç›‘å¬æ­¤äº‹ä»¶ä¸”å“åº”çŠ¶æ€ç ä¸º <code>101 Switching Protocols</code>ï¼Œåˆ™æ¥æ”¶å‡çº§å“åº”å¤´çš„å®¢æˆ·ç«¯å°†å…³é—­å…¶è¿æ¥ã€‚</p> <p>æ­¤äº‹ä»¶ä¿è¯ä¼ å…¥<a href="http://nodejs.cn/s/wsJ1o1" target="_blank" rel="noopener noreferrer">&lt;net.Socket&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ç±»ï¼ˆ<a href="http://nodejs.cn/s/2iRabr" target="_blank" rel="noopener noreferrer">&lt;stream.Duplex&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>çš„å­ç±»ï¼‰çš„å®ä¾‹ï¼Œé™¤éç”¨æˆ·æŒ‡å®šäº†<a href="http://nodejs.cn/s/wsJ1o1" target="_blank" rel="noopener noreferrer">&lt;net.Socket&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ä»¥å¤–çš„<code>Socket</code>ç±»å‹ã€‚</p> <p>å®¢æˆ·ç«¯æœåŠ¡å™¨å¯¹ï¼Œæ¼”ç¤ºå¦‚ä½•ç›‘å¬ <code>'upgrade'</code> äº‹ä»¶ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ›å»º HTTP æœåŠ¡å™¨ã€‚</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/plain'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'å“åº”å†…å®¹'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'upgrade'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> socket<span class="token punctuation">,</span> head</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  socket<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'HTTP/1.1 101 Web Socket Protocol Handshake\r\n'</span> <span class="token operator">+</span>
               <span class="token string">'Upgrade: WebSocket\r\n'</span> <span class="token operator">+</span>
               <span class="token string">'Connection: Upgrade\r\n'</span> <span class="token operator">+</span>
               <span class="token string">'\r\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  socket<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>socket<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å“åº”å›å»ã€‚</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æœåŠ¡å™¨æ­£åœ¨è¿è¡Œã€‚</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">1337</span><span class="token punctuation">,</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token comment">// å‘é€è¯·æ±‚ã€‚</span>
  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
    port<span class="token operator">:</span> <span class="token number">1337</span><span class="token punctuation">,</span>
    host<span class="token operator">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
    headers<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">'Connection'</span><span class="token operator">:</span> <span class="token string">'Upgrade'</span><span class="token punctuation">,</span>
      <span class="token string">'Upgrade'</span><span class="token operator">:</span> <span class="token string">'websocket'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> req <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  req<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'upgrade'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> socket<span class="token punctuation">,</span> upgradeHead</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ¥æ”¶åˆ°å“åº”'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    socket<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_7-2-request-aborted"><a href="#_7-2-request-aborted" class="header-anchor">ğŸŒ™</a> 7.2 <code>request.aborted</code></h3> <boolean><p>å¦‚æœè¯·æ±‚å·²ä¸­æ­¢ï¼Œåˆ™ <code>request.aborted</code> å±æ€§å°†ä¼šä¸º <code>true</code>ã€‚</p> <h3 id="_7-3-request-end-data-encoding-callback"><a href="#_7-3-request-end-data-encoding-callback" class="header-anchor">ğŸŒ™</a> 7.3 <code>request.end([data[, encoding]][, callback])</code></h3> <ul><li>data: <string> | <Buffer></Buffer></string></li> <li>encoding: <string></string></li> <li>callback: <function></function></li> <li>è¿”å›ï¼šthis ---&gt; requestï¼Œå³ å¯ä»¥é“¾å¼è°ƒç”¨</li></ul> <h3 id="_7-4-request-destroy-error"><a href="#_7-4-request-destroy-error" class="header-anchor">ğŸŒ™</a> 7.4 <code>request.destroy([error])</code></h3> <ul><li>error: <Error></Error></li> <li>è¿”å›ï¼š this</li></ul> <h5 id="_7-5-request-destroyed"><a href="#_7-5-request-destroyed" class="header-anchor">ğŸŒ™</a> 7.5 <code>request.destroyed</code></h5> <boolean><p>åœ¨<code>request.destroyed</code>è°ƒç”¨ä¹‹åå˜ä¸º<code>true</code></p> <h3 id="_7-6-request-flushheaders"><a href="#_7-6-request-flushheaders" class="header-anchor">ğŸŒ™</a> 7.6  <code>request.flushHeaders()</code></h3> <p>åˆ·æ–°è¯·æ±‚å¤´ã€‚</p> <p>å‡ºäºæ•ˆç‡åŸå› ï¼ŒNode.js é€šå¸¸ä¼šç¼“å†²è¯·æ±‚å¤´ï¼Œç›´åˆ°è°ƒç”¨ <code>request.end()</code> æˆ–å†™å…¥ç¬¬ä¸€ä¸ªè¯·æ±‚æ•°æ®å—ã€‚ ç„¶åï¼Œå®ƒå°è¯•å°†è¯·æ±‚å¤´å’Œæ•°æ®æ‰“åŒ…åˆ°å•ä¸ª TCP æ•°æ®åŒ…ä¸­ã€‚</p> <p>è¿™é€šå¸¸æ˜¯æœŸæœ›çš„ï¼ˆå®ƒèŠ‚çœäº† TCP å¾€è¿”ï¼‰ï¼Œä½†æ˜¯å¯èƒ½å¾ˆæ™šæ‰å‘é€ç¬¬ä¸€ä¸ªæ•°æ®ã€‚ <code>request.flushHeaders()</code> ç»•è¿‡ä¼˜åŒ–å¹¶å¯åŠ¨è¯·æ±‚ã€‚</p> <h3 id="_7-7-request-getheader-name"><a href="#_7-7-request-getheader-name" class="header-anchor">ğŸŒ™</a> 7.7 <code>request.getHeader(name)</code></h3> <ul><li><p>name: <string></string></p></li> <li><p>è¿”å›ï¼š<any></any></p></li></ul> <p>è¯»å–è¯·æ±‚ä¸­çš„ä¸€ä¸ªè¯·æ±‚å¤´ã€‚ è¯¥åç§°ä¸åŒºåˆ†å¤§å°å†™ã€‚ è¿”å›å€¼çš„ç±»å‹å–å†³äºæä¾›ç»™ <a href="http://nodejs.cn/s/ZBShBB" target="_blank" rel="noopener noreferrer"><code>request.setHeader()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„å‚æ•°ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>request<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'content-type'</span><span class="token punctuation">,</span> <span class="token string">'text/html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
request<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Length'</span><span class="token punctuation">,</span> Buffer<span class="token punctuation">.</span><span class="token function">byteLength</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
request<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Cookie'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'type=ninja'</span><span class="token punctuation">,</span> <span class="token string">'language=javascript'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> contentType <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 'contentType' æ˜¯ 'text/html'ã€‚</span>
<span class="token keyword">const</span> contentLength <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Length'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 'contentLength' çš„ç±»å‹ä¸ºæ•°å€¼ã€‚</span>
<span class="token keyword">const</span> cookie <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">'Cookie'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 'cookie' çš„ç±»å‹ä¸ºå­—ç¬¦ä¸²æ•°ç»„ã€‚</span>
</code></pre></div><h3 id="_7-8-request-maxheaderscount"><a href="#_7-8-request-maxheaderscount" class="header-anchor">ğŸŒ™</a> 7.8 <code>request.maxHeadersCount</code></h3> <ul><li><a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a> <strong>é»˜è®¤å€¼:</strong> <code>2000</code>ã€‚</li></ul> <p>é™åˆ¶æœ€å¤§å“åº”å¤´æ•°ã€‚ å¦‚æœè®¾ç½®ä¸º <code>0</code>ï¼Œåˆ™ä¸ä¼šåº”ç”¨ä»»ä½•é™åˆ¶ã€‚</p> <h3 id="_7-9-request-path"><a href="#_7-9-request-path" class="header-anchor">ğŸŒ™</a> 7.9 <code>request.path</code></h3> <ul><li><a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> è¯·æ±‚çš„è·¯å¾„ã€‚</li></ul> <h3 id="_7-10-request-removeheader-name"><a href="#_7-10-request-removeheader-name" class="header-anchor">ğŸŒ™</a> 7.10 <code>request.removeHeader(name)</code></h3> <ul><li><code>name</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a></li></ul> <p>ç§»é™¤å·²å®šä¹‰åˆ°è¯·æ±‚å¤´å¯¹è±¡ä¸­çš„è¯·æ±‚å¤´ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>request<span class="token punctuation">.</span><span class="token function">removeHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_7-11-request-setheader-name-value"><a href="#_7-11-request-setheader-name-value" class="header-anchor">ğŸŒ™</a> 7.11 <code>request.setHeader(name, value)</code></h3> <ul><li>name: <string></string></li> <li>value: <any></any></li></ul> <p>ä¸ºè¯·æ±‚å¤´å¯¹è±¡è®¾ç½®å•ä¸ªè¯·æ±‚å¤´çš„å€¼ã€‚</p> <p>å¦‚æœæ­¤è¯·æ±‚å¤´å·²å­˜åœ¨äºå¾…å‘é€çš„è¯·æ±‚å¤´ä¸­ï¼Œåˆ™å…¶å€¼å°†è¢«æ›¿æ¢ã€‚ è¿™é‡Œå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²æ•°ç»„æ¥å‘é€å…·æœ‰ç›¸åŒåç§°çš„å¤šä¸ªè¯·æ±‚å¤´ã€‚ éå­—ç¬¦ä¸²å€¼å°†è¢«åŸæ ·ä¿å­˜ã€‚ å› æ­¤ <a href="http://nodejs.cn/s/noVJNv" target="_blank" rel="noopener noreferrer"><code>request.getHeader()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å¯èƒ½ä¼šè¿”å›éå­—ç¬¦ä¸²å€¼ã€‚ ä½†æ˜¯éå­—ç¬¦ä¸²å€¼å°†è½¬æ¢ä¸ºå­—ç¬¦ä¸²ä»¥è¿›è¡Œç½‘ç»œä¼ è¾“ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>request<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'application/json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// æˆ–ï¼š</span>
request<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Cookie'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'type=ninja'</span><span class="token punctuation">,</span> <span class="token string">'language=javascript'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_7-12-request-setnodelay-nodelay"><a href="#_7-12-request-setnodelay-nodelay" class="header-anchor">ğŸŒ™</a> 7.12 <code>request.setNoDelay([noDelay])</code></h3> <ul><li><code>noDelay</code> <a href="http://nodejs.cn/s/jFbvuT" target="_blank" rel="noopener noreferrer"><boolean><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></boolean></a></li></ul> <p>ä¸€æ—¦å°†<code>Socket</code>åˆ†é…ç»™æ­¤è¯·æ±‚å¹¶ä¸”è¿æ¥äº†<code>Socket</code>ï¼Œå°±ä¼šè°ƒç”¨ <a href="http://nodejs.cn/s/q9UswY" target="_blank" rel="noopener noreferrer"><code>socket.setNoDelay()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <h3 id="_7-13-request-setsocketkeepalive-enable-initialdelay"><a href="#_7-13-request-setsocketkeepalive-enable-initialdelay" class="header-anchor">ğŸŒ™</a> 7.13 <code>request.setSocketKeepAlive([enable][, initialDelay])</code></h3> <ul><li><code>enable</code> <a href="http://nodejs.cn/s/jFbvuT" target="_blank" rel="noopener noreferrer"><boolean><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></boolean></a></li> <li><code>initialDelay</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a></li></ul> <p>ä¸€æ—¦å°†<code>Socket</code>åˆ†é…ç»™æ­¤è¯·æ±‚å¹¶è¿æ¥äº†<code>Socket</code>ï¼Œå°±ä¼šè°ƒç”¨ <a href="http://nodejs.cn/s/qqbgUD" target="_blank" rel="noopener noreferrer"><code>socket.setKeepAlive()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <h3 id="_7-14-request-settimeout-timeout-callback"><a href="#_7-14-request-settimeout-timeout-callback" class="header-anchor">ğŸŒ™</a> 7.14 <code>request.setTimeout(timeout[, callback])</code></h3> <ul><li><code>timeout</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a> è¯·æ±‚è¶…æ—¶å‰çš„æ¯«ç§’æ•°ã€‚</li> <li><code>callback</code> <a href="http://nodejs.cn/s/ceTQa6" target="_blank" rel="noopener noreferrer"><function><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></function></a> å‘ç”Ÿè¶…æ—¶æ—¶è¦è°ƒç”¨çš„å¯é€‰å‡½æ•°ã€‚ç›¸å½“äºç»‘å®šåˆ° <code>'timeout'</code> äº‹ä»¶ã€‚</li> <li>è¿”å›: <a href="http://nodejs.cn/s/2F5RHd" target="_blank" rel="noopener noreferrer">http.ClientRequest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>ä¸€æ—¦å°†<code>Socket</code>åˆ†é…ç»™æ­¤è¯·æ±‚å¹¶ä¸”è¿æ¥äº†<code>Socket</code>ï¼Œå°±ä¼šè°ƒç”¨ <a href="http://nodejs.cn/s/XC4Yyj" target="_blank" rel="noopener noreferrer"><code>socket.setTimeout()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <h3 id="_7-15-request-socket"><a href="#_7-15-request-socket" class="header-anchor">ğŸŒ™</a> 7.15 <code>request.socket</code></h3> <ul><li><a href="http://nodejs.cn/s/2iRabr" target="_blank" rel="noopener noreferrer">&lt;stream.Duplex&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>æŒ‡å‘åº•å±‚<code>Socket</code>ã€‚ é€šå¸¸ç”¨æˆ·æ— éœ€è®¿é—®æ­¤å±æ€§ã€‚ ç‰¹åˆ«æ˜¯ï¼Œç”±äºåè®®è§£æå™¨é™„åŠ åˆ°<code>Socket</code>çš„æ–¹å¼ï¼Œ<code>Socket</code>å°†ä¸ä¼šè§¦å‘ <code>'readable'</code> äº‹ä»¶ã€‚ ä¹Ÿå¯ä»¥é€šè¿‡ <code>request.connection</code> è®¿é—® <code>socket</code>ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  host<span class="token operator">:</span> <span class="token string">'nodejs.cn'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> req <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
req<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
req<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">'response'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ip <span class="token operator">=</span> req<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>localAddress<span class="token punctuation">;</span>
  <span class="token keyword">const</span> port <span class="token operator">=</span> req<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>localPort<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">æ‚¨çš„ IP åœ°å€æ˜¯ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ip<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ï¼Œæºç«¯å£æ˜¯ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ä½¿ç”¨å“åº”å¯¹è±¡ã€‚</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_7-16-request-writablefinished"><a href="#_7-16-request-writablefinished" class="header-anchor">ğŸŒ™</a> 7.16 <code>request.writableFinished</code></h3> <ul><li><a href="http://nodejs.cn/s/jFbvuT" target="_blank" rel="noopener noreferrer">boolean<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>å¦‚æœåœ¨è§¦å‘ <a href="http://nodejs.cn/s/yLFDX9" target="_blank" rel="noopener noreferrer"><code>'finish'</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> äº‹ä»¶ä¹‹å‰ï¼Œæ‰€æœ‰æ•°æ®éƒ½å·²åˆ·æ–°åˆ°åº•å±‚ç³»ç»Ÿï¼Œåˆ™ä¸º <code>true</code>ã€‚</p> <h3 id="_7-17-request-write-chunk-encoding-callback"><a href="#_7-17-request-write-chunk-encoding-callback" class="header-anchor">ğŸŒ™</a> 7.17 <code>request.write(chunk[, encoding][, callback])</code></h3> <ul><li><code>chunk</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> | <a href="http://nodejs.cn/s/6x1hD3" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><code>encoding</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a></li> <li><code>callback</code> <a href="http://nodejs.cn/s/ceTQa6" target="_blank" rel="noopener noreferrer"><function><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></function></a></li> <li>è¿”å›: <a href="http://nodejs.cn/s/jFbvuT" target="_blank" rel="noopener noreferrer"><boolean><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></boolean></a></li></ul> <p>å‘é€ä¸€ä¸ªè¯·æ±‚ä¸»ä½“çš„æ•°æ®å—ã€‚ é€šè¿‡å¤šæ¬¡è°ƒç”¨æ­¤æ–¹æ³•ï¼Œå¯ä»¥å°†è¯·æ±‚ä¸»ä½“å‘é€åˆ°æœåŠ¡å™¨ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå»ºè®®åœ¨åˆ›å»ºè¯·æ±‚æ—¶ä½¿ç”¨ <code>['Transfer-Encoding', 'chunked']</code> è¯·æ±‚å¤´è¡Œã€‚</p> <p><code>encoding</code> å‚æ•°æ˜¯å¯é€‰çš„ï¼Œä»…å½“ <code>chunk</code> æ˜¯å­—ç¬¦ä¸²æ—¶æ‰é€‚ç”¨ã€‚ é»˜è®¤ä¸º <code>'utf8'</code>ã€‚</p> <p><code>callback</code> å‚æ•°æ˜¯å¯é€‰çš„ï¼Œå½“åˆ·æ–°æ­¤æ•°æ®å—æ—¶è°ƒç”¨ï¼Œä½†ä»…å½“æ•°æ®å—éç©ºæ—¶æ‰ä¼šè°ƒç”¨ã€‚</p> <p>å¦‚æœå°†æ•´ä¸ªæ•°æ®æˆåŠŸåˆ·æ–°åˆ°å†…æ ¸ç¼“å†²åŒºï¼Œåˆ™è¿”å› <code>true</code>ã€‚ å¦‚æœå…¨éƒ¨æˆ–éƒ¨åˆ†æ•°æ®åœ¨ç”¨æˆ·å†…å­˜ä¸­æ’é˜Ÿï¼Œåˆ™è¿”å› <code>false</code>ã€‚ å½“ç¼“å†²åŒºå†æ¬¡ç©ºé—²æ—¶ï¼Œåˆ™è§¦å‘ <code>'drain'</code> äº‹ä»¶ã€‚</p> <p>å½“ä½¿ç”¨ç©ºå­—ç¬¦ä¸²æˆ– buffer è°ƒç”¨ <code>write</code> å‡½æ•°æ—¶ï¼Œåˆ™ä»€ä¹ˆä¹Ÿä¸åšä¸”ç­‰å¾…æ›´å¤šè¾“å…¥ã€‚</p> <h3 id="_7-17-request-reusedsocket"><a href="#_7-17-request-reusedsocket" class="header-anchor">ğŸŒ™</a> 7.17 <code>request.reusedSocket</code></h3> <boolean><p>åˆ¤æ–­<code>request</code>æ˜¯å¦æ˜¯é€šè¿‡ä¸€ä¸ªè¢«æ‹’ç»çš„<code>socket</code>å‘é€ã€‚</p> <p>å½“é€šè¿‡å¯ç”¨ä¿æŒ<code>keep-alive</code> çš„ä»£ç†å‘é€è¯·æ±‚æ—¶ï¼Œåº•å±‚çš„<code>socket</code>å¯èƒ½æœƒè¢«æ‹’çµ•ã€‚ä½†æ˜¯ï¼Œå¦‚æœæœåŠ¡å™¨åœ¨ä¸å¹¸çš„æ—¶é—´å…³é—­è¿æ¥ï¼Œåˆ™å®¢æˆ·ç«¯å¯èƒ½ä¼šé‡åˆ°â€œ ECONNRESETâ€é”™è¯¯ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Server has a 5 seconds keep-alive timeout by default</span>
http
  <span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'hello\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Adapting a keep-alive agent</span>
  http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://localhost:3000'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> agent <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// Do nothing</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Sending request on 5s interval so it's easy to hit idle timeout</span>
</code></pre></div><p>é€šè¿‡åˆ¤æ–­<code>req.reusedSocket</code>çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡é‡æ–°å¯ç”¨è¿æ¥ï¼Œä»è€Œé¿å…è¿™ä¸ªé”™è¯¯ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> agent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">http<span class="token punctuation">.</span>Agent</span><span class="token punctuation">(</span><span class="token punctuation">{</span> keepAlive<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">retriableRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> req <span class="token operator">=</span> http
    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://localhost:3000'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> agent <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// Check if retry is needed</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>reusedSocket <span class="token operator">&amp;&amp;</span> err<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">'ECONNRESET'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">retriableRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">retriableRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_8-http-serverresponse-ç±»"><a href="#_8-http-serverresponse-ç±»" class="header-anchor">ğŸŒ™</a> 8.http.ServerResponse ç±»</h2> <p>ç»§æ‰¿è‡ª: <a href="http://nodejs.cn/s/t73H94" target="_blank" rel="noopener noreferrer"><Stream><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Stream></a></p> <p>æºç è§£è¯»ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  ServerResponse
    <span class="token operator">...</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'_http_server'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  ServerResponse<span class="token punctuation">,</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><code>http.ServerResponse</code> ç±»ç›´æ¥å°†<code>_http_server</code>ä¸­çš„<code>ServerResponse</code>å¼•å…¥å¹¶å¯¼å‡ºã€‚</p> <p>æ­¤å¯¹è±¡ç”± HTTP æœåŠ¡å™¨åœ¨å†…éƒ¨åˆ›å»ºï¼Œè€Œä¸æ˜¯ç”±ç”¨æˆ·åˆ›å»ºã€‚ å®ƒä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ ç»™ <a href="http://nodejs.cn/s/2qCn57" target="_blank" rel="noopener noreferrer"><code>'request'</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> äº‹ä»¶ã€‚â€”â€” <a href="http://nodejs.cn/api/http.html#http_class_http_serverresponse" target="_blank" rel="noopener noreferrer">å®˜ç½‘<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_8-1-http-serverresponse-äº‹ä»¶ç›‘å¬"><a href="#_8-1-http-serverresponse-äº‹ä»¶ç›‘å¬" class="header-anchor">ğŸŒ™</a> 8.1 http.ServerResponse äº‹ä»¶ç›‘å¬</h3> <h4 id="_8-1-1-close-äº‹ä»¶"><a href="#_8-1-1-close-äº‹ä»¶" class="header-anchor">ğŸŒ™</a> 8.1.1 'close' äº‹ä»¶</h4> <p>è¡¨æ˜åº•å±‚çš„è¿æ¥å·²è¢«ç»ˆæ­¢ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_8-1-2-finish-äº‹ä»¶"><a href="#_8-1-2-finish-äº‹ä»¶" class="header-anchor">ğŸŒ™</a> 8.1.2 'finish' äº‹ä»¶</h4> <p>å“åº”å‘é€åè§¦å‘ã€‚ æ›´å…·ä½“åœ°è¯´ï¼Œå½“å“åº”å¤´å’Œä¸»ä½“çš„æœ€åä¸€æ®µå·²ç»åˆ‡æ¢åˆ°æ“ä½œç³»ç»Ÿä»¥é€šè¿‡ç½‘ç»œä¼ è¾“æ—¶ï¼Œè§¦å‘è¯¥äº‹ä»¶ã€‚ è¿™å¹¶ä¸æ„å‘³ç€å®¢æˆ·ç«¯å·²æ”¶åˆ°ä»»ä½•ä¿¡æ¯ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'finish'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_8-2-response-cork"><a href="#_8-2-response-cork" class="header-anchor">ğŸŒ™</a> 8.2 <code>response.cork()</code></h3> <p>ç»§æ‰¿è‡ªstream.Writable ç±»,åŒ <a href="http://nodejs.cn/s/HbaGHW" target="_blank" rel="noopener noreferrer"><code>writable.cork()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><code>writable.cork()</code> æ–¹æ³•å¼ºåˆ¶æŠŠæ‰€æœ‰å†™å…¥çš„æ•°æ®éƒ½ç¼“å†²åˆ°å†…å­˜ä¸­ã€‚ å½“è°ƒç”¨ <a href="http://nodejs.cn/s/2Bzt8L" target="_blank" rel="noopener noreferrer"><code>stream.uncork()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æˆ– <a href="http://nodejs.cn/s/nvArK4" target="_blank" rel="noopener noreferrer"><code>stream.end()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ–¹æ³•æ—¶ï¼Œç¼“å†²çš„æ•°æ®æ‰ä¼šè¢«è¾“å‡ºã€‚</p> <p><code>writable.cork()</code> çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†é€‚åº”å°†å‡ ä¸ªæ•°æ®å¿«é€Ÿè¿ç»­åœ°å†™å…¥æµçš„æƒ…å†µã€‚ <code>writable.cork()</code> ä¸ä¼šç«‹å³å°†å®ƒä»¬è½¬å‘åˆ°åº•å±‚çš„ç›®æ ‡ï¼Œè€Œæ˜¯ç¼“å†²æ‰€æœ‰æ•°æ®å—ï¼Œç›´åˆ°è°ƒç”¨ <code>writable.uncork()</code>ï¼Œè¿™ä¼šå°†å®ƒä»¬å…¨éƒ¨ä¼ ç»™ <code>writable._writev()</code>ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚ è¿™å¯ä»¥é˜²æ­¢å‡ºç°è¡Œå¤´é˜»å¡çš„æƒ…å†µï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ­£åœ¨ç­‰å¾…ç¬¬ä¸€ä¸ªæ•°æ®å—è¢«å¤„ç†çš„åŒæ—¶å¯¹æ•°æ®è¿›è¡Œç¼“å†²ã€‚ ä½†æ˜¯ï¼Œä½¿ç”¨ <code>writable.cork()</code> è€Œä¸å®ç° <code>writable._writev()</code> å¯èƒ½ä¼šå¯¹ååé‡äº§ç”Ÿä¸åˆ©å½±å“ã€‚</p> <h3 id="_8-3-response-end-data-encoding-callback"><a href="#_8-3-response-end-data-encoding-callback" class="header-anchor">ğŸŒ™</a> 8.3 <code>response.end([data[, encoding]][, callback])</code></h3> <ul><li><code>data</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> | <a href="http://nodejs.cn/s/6x1hD3" target="_blank" rel="noopener noreferrer"><Buffer><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Buffer></a></li> <li><code>encoding</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a></li> <li><code>callback</code> <a href="http://nodejs.cn/s/ceTQa6" target="_blank" rel="noopener noreferrer"><Function><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Function></a></li> <li>è¿”å›ï¼š<this></this></li></ul> <p>æ­¤æ–¹æ³•å‘æœåŠ¡å™¨å‘å‡ºä¿¡å·ï¼Œè¡¨æ˜å·²å‘é€æ‰€æœ‰å“åº”å¤´å’Œä¸»ä½“ï¼Œè¯¥æœåŠ¡å™¨åº”è¯¥è§†ä¸ºæ­¤æ¶ˆæ¯å·²å®Œæˆã€‚ å¿…é¡»åœ¨æ¯ä¸ªå“åº”ä¸Šè°ƒç”¨æ­¤ <code>response.end()</code> æ–¹æ³•ã€‚</p> <p>å¦‚æœæŒ‡å®šäº† <code>data</code>ï¼Œåˆ™ç›¸å½“äºè°ƒç”¨ <a href="http://nodejs.cn/s/gvWo3m" target="_blank" rel="noopener noreferrer"><code>response.write(data, encoding)</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä¹‹åå†è°ƒç”¨ <code>response.end(callback)</code>ã€‚</p> <p>å¦‚æœæŒ‡å®šäº† <code>callback</code>ï¼Œåˆ™å½“å“åº”æµå®Œæˆæ—¶å°†è°ƒç”¨å®ƒã€‚</p> <h3 id="_8-4-response-flushheaders"><a href="#_8-4-response-flushheaders" class="header-anchor">ğŸŒ™</a> 8.4 <code>response.flushHeaders()</code></h3> <p>åˆ·æ–°å“åº”å¤´ã€‚ å¦å¯å‚è§ï¼š<a href="http://nodejs.cn/s/JcwoXr" target="_blank" rel="noopener noreferrer"><code>request.flushHeaders()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <h3 id="_8-5-response-getheader-name"><a href="#_8-5-response-getheader-name" class="header-anchor">ğŸŒ™</a> 8.5 <code>response.getHeader(name)</code></h3> <ul><li><code>name</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a></li> <li>è¿”å›: <a href="http://nodejs.cn/s/6sTGdS" target="_blank" rel="noopener noreferrer"><any><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></any></a></li></ul> <p>è¯»å‡ºå·²æ’é˜Ÿä½†æœªå‘é€åˆ°å®¢æˆ·ç«¯çš„å“åº”å¤´ã€‚ è¯¥åç§°ä¸åŒºåˆ†å¤§å°å†™ã€‚ è¿”å›å€¼çš„ç±»å‹å–å†³äºæä¾›ç»™ <a href="http://nodejs.cn/s/rqeM3J" target="_blank" rel="noopener noreferrer"><code>response.setHeader()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„å‚æ•°ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Length'</span><span class="token punctuation">,</span> Buffer<span class="token punctuation">.</span><span class="token function">byteLength</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Set-Cookie'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'type=ninja'</span><span class="token punctuation">,</span> <span class="token string">'language=javascript'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> contentType <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">'content-type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// contentType æ˜¯ 'text/html'ã€‚</span>
<span class="token keyword">const</span> contentLength <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Length'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// contentLength çš„ç±»å‹ä¸ºæ•°å€¼ã€‚</span>
<span class="token keyword">const</span> setCookie <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">'set-cookie'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// setCookie çš„ç±»å‹ä¸ºå­—ç¬¦ä¸²æ•°ç»„ã€‚</span>
</code></pre></div><h3 id="_8-6-response-getheadernames"><a href="#_8-6-response-getheadernames" class="header-anchor">ğŸŒ™</a> 8.6 <code>response.getHeaderNames()</code></h3> <ul><li>è¿”å›: <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer">&lt;string[]&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­åŒ…å«å½“å‰ä¼ å‡ºçš„å“åº”å¤´çš„å”¯ä¸€åç§°ã€‚ æ‰€æœ‰å“åº”å¤´åç§°éƒ½æ˜¯å°å†™çš„ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Set-Cookie'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'foo=bar'</span><span class="token punctuation">,</span> <span class="token string">'bar=baz'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> headerNames <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHeaderNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// headerNames === ['foo', 'set-cookie']</span>
</code></pre></div><h3 id="_8-7-response-getheaders"><a href="#_8-7-response-getheaders" class="header-anchor">ğŸŒ™</a> 8.7 <code>response.getHeaders()</code></h3> <ul><li>è¿”å›: <a href="http://nodejs.cn/s/jzn6Ao" target="_blank" rel="noopener noreferrer"><Object><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Object></a></li></ul> <p>è¿”å›å½“å‰ä¼ å‡ºçš„å“åº”å¤´çš„æµ…æ‹·è´ã€‚ ç”±äºä½¿ç”¨æµ…æ‹·è´ï¼Œå› æ­¤å¯ä»¥æ›´æ”¹æ•°ç»„çš„å€¼è€Œæ— éœ€é¢å¤–è°ƒç”¨å„ç§ä¸å“åº”å¤´ç›¸å…³çš„ http æ¨¡å—æ–¹æ³•ã€‚ è¿”å›å¯¹è±¡çš„é”®æ˜¯å“åº”å¤´åç§°ï¼Œå€¼æ˜¯å„è‡ªçš„å“åº”å¤´å€¼ã€‚ æ‰€æœ‰å“åº”å¤´åç§°éƒ½æ˜¯å°å†™çš„ã€‚</p> <p><strong><code>response.getHeaders()</code> æ–¹æ³•è¿”å›çš„å¯¹è±¡ä¸æ˜¯ä» JavaScript <code>Object</code> åŸå‹ç»§æ‰¿çš„</strong>ã€‚ è¿™æ„å‘³ç€å…¸å‹çš„ <code>Object</code> æ–¹æ³•ï¼Œå¦‚ <code>obj.toString()</code>ã€ <code>obj.hasOwnProperty()</code> ç­‰éƒ½æ²¡æœ‰å®šä¹‰å¹¶ä¸”ä¸èµ·ä½œç”¨ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Set-Cookie'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'foo=bar'</span><span class="token punctuation">,</span> <span class="token string">'bar=baz'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> headers <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// headers === { foo: 'bar', 'set-cookie': ['foo=bar', 'bar=baz'] }</span>
</code></pre></div><p>æºç è§£è¯»ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Returns a shallow copy of the current outgoing headers.</span>
<span class="token class-name">OutgoingMessage</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getHeaders</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> headers <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span>kOutHeaders<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> ret <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¯¹è±¡ä¸æ˜¯ä» JavaScript `Object` åŸå‹ç»§æ‰¿çš„ï¼Œç”Ÿæˆä¸€ä¸ªçº¯ç²¹çš„ {}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>headers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> keys<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> key <span class="token operator">=</span> keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> val <span class="token operator">=</span> headers<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      ret<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>å¯ä»¥çœ‹å‡º<code>response</code>æ˜¯<code>OutgoingMessage</code>çš„å®ä¾‹åŒ–å¯¹è±¡ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span>
<span class="token keyword">new</span> <span class="token class-name">http<span class="token punctuation">.</span>Server</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>statusCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res <span class="token keyword">instanceof</span> <span class="token class-name">http<span class="token punctuation">.</span>OutgoingMessage</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">7777</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_8-8-response-hasheader-name"><a href="#_8-8-response-hasheader-name" class="header-anchor">ğŸŒ™</a> 8.8 <code>response.hasHeader(name)</code></h3> <ul><li><code>name</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a></li> <li>è¿”å›: <a href="http://nodejs.cn/s/jFbvuT" target="_blank" rel="noopener noreferrer"><boolean><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></boolean></a></li></ul> <p>å¦‚æœå½“å‰åœ¨ä¼ å‡ºçš„å“åº”å¤´ä¸­è®¾ç½®äº†ç”± <code>name</code> æ ‡è¯†çš„å“åº”å¤´ï¼Œåˆ™è¿”å› <code>true</code>ã€‚ å“åº”å¤´åç§°åŒ¹é…ä¸åŒºåˆ†å¤§å°å†™ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> hasContentType <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">hasHeader</span><span class="token punctuation">(</span><span class="token string">'content-type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_8-9-response-removeheader-name"><a href="#_8-9-response-removeheader-name" class="header-anchor">ğŸŒ™</a> 8.9 <code>response.removeHeader(name)</code></h3> <ul><li><code>name</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a></li></ul> <p>ç§»é™¤æ’é˜Ÿç­‰å¾…ä¸­çš„éšå¼å‘é€çš„å“åº”å¤´ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>response<span class="token punctuation">.</span><span class="token function">removeHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Encoding'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_8-10-response-setheader-name-value"><a href="#_8-10-response-setheader-name-value" class="header-anchor">ğŸŒ™</a> 8.10 <code>response.setHeader(name, value)</code></h3> <ul><li><code>name</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a></li> <li><code>value</code> <a href="http://nodejs.cn/s/6sTGdS" target="_blank" rel="noopener noreferrer"><any><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></any></a></li></ul> <p>ä¸ºéšå¼å“åº”å¤´è®¾ç½®å•ä¸ªå“åº”å¤´çš„å€¼ã€‚ å¦‚æœæ­¤å“åº”å¤´å·²å­˜åœ¨äºå¾…å‘é€çš„å“åº”å¤´ä¸­ï¼Œåˆ™å…¶å€¼å°†è¢«æ›¿æ¢ã€‚ åœ¨è¿™é‡Œå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²æ•°ç»„æ¥å‘é€å…·æœ‰ç›¸åŒåç§°çš„å¤šä¸ªå“åº”å¤´ã€‚ éå­—ç¬¦ä¸²å€¼å°†è¢«åŸæ ·ä¿å­˜ã€‚ å› æ­¤ <a href="http://nodejs.cn/s/pbE7VN" target="_blank" rel="noopener noreferrer"><code>response.getHeader()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å¯èƒ½è¿”å›éå­—ç¬¦ä¸²å€¼ã€‚ ä½†æ˜¯éå­—ç¬¦ä¸²å€¼å°†è½¬æ¢ä¸ºå­—ç¬¦ä¸²ä»¥è¿›è¡Œç½‘ç»œä¼ è¾“ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æˆ–ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Set-Cookie'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'type=ninja'</span><span class="token punctuation">,</span> <span class="token string">'language=javascript'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å°è¯•è®¾ç½®åŒ…å«æ— æ•ˆå­—ç¬¦çš„å“åº”å¤´å­—æ®µåç§°æˆ–å€¼å°†å¯¼è‡´æŠ›å‡º <a href="http://nodejs.cn/s/Z7Lqyj" target="_blank" rel="noopener noreferrer"><code>TypeError</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <p>å½“ä½¿ç”¨ <a href="http://nodejs.cn/s/rqeM3J" target="_blank" rel="noopener noreferrer"><code>response.setHeader()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> è®¾ç½®å“åº”å¤´æ—¶ï¼Œå®ƒä»¬å°†ä¸ä¼ ç»™ <a href="http://nodejs.cn/s/fnj9oM" target="_blank" rel="noopener noreferrer"><code>response.writeHead()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„ä»»ä½•å“åº”å¤´åˆå¹¶ï¼Œå…¶ä¸­ <strong><a href="http://nodejs.cn/s/fnj9oM" target="_blank" rel="noopener noreferrer"><code>response.writeHead()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„å“åº”å¤´ä¼˜å…ˆ</strong>ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è¿”å› content-type = text/plain</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'X-Foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/plain'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å¦‚æœè°ƒç”¨äº† <a href="http://nodejs.cn/s/fnj9oM" target="_blank" rel="noopener noreferrer"><code>response.writeHead()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ–¹æ³•å¹¶ä¸”å°šæœªè°ƒç”¨æ­¤æ–¹æ³•ï¼Œåˆ™å®ƒå°†ç›´æ¥å°†æä¾›çš„å“åº”å¤´å€¼å†™å…¥ç½‘ç»œé€šé“è€Œä¸åœ¨å†…éƒ¨è¿›è¡Œç¼“å­˜ï¼Œå¹¶ä¸”å“åº”å¤´ä¸Šçš„ <a href="http://nodejs.cn/s/pbE7VN" target="_blank" rel="noopener noreferrer"><code>response.getHeader()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å°†ä¸ä¼šäº§ç”Ÿé¢„æœŸçš„ç»“æœã€‚ å¦‚æœéœ€è¦æ¸è¿›çš„å“åº”å¤´å¡«å……ä»¥åŠå°†æ¥å¯èƒ½çš„æ£€ç´¢å’Œä¿®æ”¹ï¼Œåˆ™ä½¿ç”¨ <a href="http://nodejs.cn/s/rqeM3J" target="_blank" rel="noopener noreferrer"><code>response.setHeader()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> è€Œä¸æ˜¯ <a href="http://nodejs.cn/s/fnj9oM" target="_blank" rel="noopener noreferrer"><code>response.writeHead()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <h3 id="_8-11-response-settimeout-msecs-callback"><a href="#_8-11-response-settimeout-msecs-callback" class="header-anchor">ğŸŒ™</a> 8.11 <code>response.setTimeout(msecs[, callback])</code></h3> <ul><li><code>msecs</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a></li> <li><code>callback</code> <a href="http://nodejs.cn/s/ceTQa6" target="_blank" rel="noopener noreferrer"><Function><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Function></a></li> <li>è¿”å›: <a href="http://nodejs.cn/s/rMXoZ1" target="_blank" rel="noopener noreferrer">&lt;http.ServerResponse&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>å°†Socketçš„è¶…æ—¶å€¼è®¾ç½®ä¸º <code>msecs</code>ã€‚ å¦‚æœæä¾›äº†å›è°ƒï¼Œåˆ™ä¼šå°†å…¶ä½œä¸ºç›‘å¬å™¨æ·»åŠ åˆ°å“åº”å¯¹è±¡ä¸Šçš„ <code>'timeout'</code> äº‹ä»¶ä¸­ã€‚</p> <p>å¦‚æœæ²¡æœ‰ <code>'timeout'</code> ç›‘å¬å™¨æ·»åŠ åˆ°è¯·æ±‚ã€å“åº”ã€æˆ–æœåŠ¡å™¨ï¼Œåˆ™<code>Socket</code>åœ¨è¶…æ—¶æ—¶å°†è¢«é”€æ¯ã€‚ å¦‚æœæœ‰å›è°ƒå¤„ç†å‡½æ•°åˆ†é…ç»™è¯·æ±‚ã€å“åº”ã€æˆ–æœåŠ¡å™¨çš„ <code>'timeout'</code> äº‹ä»¶ï¼Œåˆ™å¿…é¡»æ˜¾å¼å¤„ç†è¶…æ—¶çš„<code>Socket</code>ã€‚</p> <h3 id="_8-12-response-socket"><a href="#_8-12-response-socket" class="header-anchor">ğŸŒ™</a> 8.12 <code>response.socket</code></h3> <p><a href="http://nodejs.cn/s/2iRabr" target="_blank" rel="noopener noreferrer">&lt;stream.Duplex&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>æŒ‡å‘åº•å±‚çš„<code>socket</code>ã€‚ é€šå¸¸ç”¨æˆ·ä¸éœ€è¦è®¿é—®æ­¤å±æ€§ã€‚ ç‰¹åˆ«æ˜¯ï¼Œç”±äºåè®®è§£æå™¨é™„åŠ åˆ°<code>socket</code>çš„æ–¹å¼ï¼Œ<code>socket</code>å°†ä¸ä¼šè§¦å‘ <code>'readable'</code> äº‹ä»¶ã€‚ åœ¨è°ƒç”¨ <code>response.end()</code> ä¹‹åï¼Œæ­¤å±æ€§å°†ä¸ºç©ºã€‚ ä¹Ÿå¯ä»¥é€šè¿‡ <code>response.connection</code> è®¿é—® <code>socket</code>ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ip <span class="token operator">=</span> res<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>remoteAddress<span class="token punctuation">;</span>
  <span class="token keyword">const</span> port <span class="token operator">=</span> res<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>remotePort<span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">æ‚¨çš„ IP åœ°å€æ˜¯ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ip<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ï¼Œæ‚¨çš„æºç«¯å£æ˜¯ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æ­¤å±æ€§ä¿è¯æ˜¯ <a href="http://nodejs.cn/s/wsJ1o1" target="_blank" rel="noopener noreferrer">&lt;net.Socket&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ç±»ï¼ˆ<a href="http://nodejs.cn/s/2iRabr" target="_blank" rel="noopener noreferrer">&lt;stream.Duplex&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„å­ç±»ï¼‰çš„å®ä¾‹ï¼Œé™¤éç”¨æˆ·æŒ‡å®šäº† <a href="http://nodejs.cn/s/wsJ1o1" target="_blank" rel="noopener noreferrer">&lt;net.Socket&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä»¥å¤–çš„<code>socket</code>ç±»å‹ã€‚</p> <h3 id="_8-13-response-statuscode"><a href="#_8-13-response-statuscode" class="header-anchor">ğŸŒ™</a> 8.13 <code>response.statusCode</code></h3> <ul><li><a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a> <strong>é»˜è®¤å€¼:</strong> <code>200</code>ã€‚</li></ul> <p>å½“ä½¿ç”¨éšå¼çš„å“åº”å¤´æ—¶ï¼ˆæ²¡æœ‰æ˜¾å¼åœ°è°ƒç”¨ <a href="http://nodejs.cn/s/fnj9oM" target="_blank" rel="noopener noreferrer"><code>response.writeHead()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼‰ï¼Œæ­¤å±æ€§æ§åˆ¶åœ¨åˆ·æ–°å“åº”å¤´æ—¶å°†å‘é€åˆ°å®¢æˆ·ç«¯çš„çŠ¶æ€ç ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>response<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">404</span><span class="token punctuation">;</span>
</code></pre></div><p>å“åº”å¤´å‘é€åˆ°å®¢æˆ·ç«¯åï¼Œæ­¤å±æ€§è¡¨ç¤ºå·²å‘é€çš„çŠ¶æ€ç ã€‚</p> <h3 id="_8-14-response-statusmessage"><a href="#_8-14-response-statusmessage" class="header-anchor">ğŸŒ™</a> 8.14 <code>response.statusMessage</code></h3> <ul><li><a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a></li></ul> <p>å½“ä½¿ç”¨éšå¼çš„å“åº”å¤´æ—¶ï¼ˆæ²¡æœ‰æ˜¾å¼åœ°è°ƒç”¨ <a href="http://nodejs.cn/s/fnj9oM" target="_blank" rel="noopener noreferrer"><code>response.writeHead()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼‰ï¼Œæ­¤å±æ€§æ§åˆ¶åœ¨åˆ·æ–°å“åº”å¤´æ—¶å°†å‘é€åˆ°å®¢æˆ·ç«¯çš„çŠ¶æ€æ¶ˆæ¯ã€‚ å¦‚æœä¿ç•™ä¸º <code>undefined</code>ï¼Œåˆ™å°†ä½¿ç”¨çŠ¶æ€ç çš„æ ‡å‡†æ¶ˆæ¯ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>response<span class="token punctuation">.</span>statusMessage <span class="token operator">=</span> <span class="token string">'Not found'</span><span class="token punctuation">;</span>
</code></pre></div><p>å“åº”å¤´å‘é€åˆ°å®¢æˆ·ç«¯åï¼Œæ­¤å±æ€§è¡¨ç¤ºå·²å‘é€çš„çŠ¶æ€æ¶ˆæ¯ã€‚</p> <h3 id="_8-15response-write-chunk-encoding-callback"><a href="#_8-15response-write-chunk-encoding-callback" class="header-anchor">ğŸŒ™</a> 8.15<code>response.write(chunk[, encoding][, callback])</code></h3> <ul><li><code>chunk</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> | <a href="http://nodejs.cn/s/6x1hD3" target="_blank" rel="noopener noreferrer"><Buffer><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Buffer></a></li> <li><code>encoding</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> <strong>é»˜è®¤å€¼:</strong> <code>'utf8'</code>ã€‚</li> <li><code>callback</code> <a href="http://nodejs.cn/s/ceTQa6" target="_blank" rel="noopener noreferrer"><Function><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Function></a></li> <li>è¿”å›: <a href="http://nodejs.cn/s/jFbvuT" target="_blank" rel="noopener noreferrer"><boolean><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></boolean></a></li></ul> <p><code>chunk</code> å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ– bufferã€‚ å¦‚æœ <code>chunk</code> æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šå¦‚ä½•å°†å…¶ç¼–ç ä¸ºå­—èŠ‚æµã€‚ å½“åˆ·æ–°æ­¤æ•°æ®å—æ—¶å°†è°ƒç”¨ <code>callback</code>ã€‚</p> <p>ç¬¬ä¸€æ¬¡è°ƒç”¨ <a href="http://nodejs.cn/s/gvWo3m" target="_blank" rel="noopener noreferrer"><code>response.write()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ—¶ï¼Œå®ƒä¼šå°†ç¼“å†²çš„å“åº”å¤´ä¿¡æ¯å’Œä¸»ä½“çš„ç¬¬ä¸€ä¸ªæ•°æ®å—å‘é€ç»™å®¢æˆ·ç«¯ã€‚ ç¬¬äºŒæ¬¡è°ƒç”¨ <a href="http://nodejs.cn/s/gvWo3m" target="_blank" rel="noopener noreferrer"><code>response.write()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> æ—¶ï¼ŒNode.js å‡å®šæ•°æ®å°†è¢«æµå¼ä¼ è¾“ï¼Œå¹¶åˆ†åˆ«å‘é€æ–°æ•°æ®ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå“åº”è¢«ç¼“å†²åˆ°ä¸»ä½“çš„ç¬¬ä¸€ä¸ªæ•°æ®å—ã€‚</p> <p>å¦‚æœå°†æ•´ä¸ªæ•°æ®æˆåŠŸåˆ·æ–°åˆ°å†…æ ¸ç¼“å†²åŒºï¼Œåˆ™è¿”å› <code>true</code>ã€‚ å¦‚æœå…¨éƒ¨æˆ–éƒ¨åˆ†æ•°æ®åœ¨ç”¨æˆ·å†…å­˜ä¸­æ’é˜Ÿï¼Œåˆ™è¿”å› <code>false</code>ã€‚ å½“ç¼“å†²åŒºå†æ¬¡ç©ºé—²æ—¶ï¼Œåˆ™è§¦å‘ <code>'drain'</code> äº‹ä»¶ã€‚</p> <h3 id="_8-16-response-writehead-statuscode-statusmessage-headers"><a href="#_8-16-response-writehead-statuscode-statusmessage-headers" class="header-anchor">ğŸŒ™</a> 8.16 <code>response.writeHead(statusCode[, statusMessage][, headers])</code></h3> <ul><li><code>statusCode</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a></li> <li><code>statusMessage</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a></li> <li><code>headers</code><a href="http://nodejs.cn/s/jzn6Ao" target="_blank" rel="noopener noreferrer"><Object><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Object></a></li> <li>è¿”å›: <a href="http://nodejs.cn/s/rMXoZ1" target="_blank" rel="noopener noreferrer">&lt;http.ServerResponse&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>å‘è¯·æ±‚å‘é€å“åº”å¤´ã€‚ çŠ¶æ€ç æ˜¯ä¸€ä¸ª 3 ä½çš„ HTTP çŠ¶æ€ç ï¼Œå¦‚ <code>404</code>ã€‚ æœ€åä¸€ä¸ªå‚æ•° <code>headers</code> æ˜¯å“åº”å¤´ã€‚ å¯ä»¥å¯é€‰åœ°å°†ç”¨æˆ·å¯è¯»çš„ <code>statusMessage</code> ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚</p> <p>è¿”å›å¯¹ <code>ServerResponse</code> çš„å¼•ç”¨ï¼Œä»¥ä¾¿å¯ä»¥é“¾å¼è°ƒç”¨ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> body <span class="token operator">=</span> <span class="token string">'hello world'</span><span class="token punctuation">;</span>
response
  <span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string">'Content-Length'</span><span class="token operator">:</span> Buffer<span class="token punctuation">.</span><span class="token function">byteLength</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/plain'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æ­¤æ–¹æ³•åªèƒ½åœ¨æ¶ˆæ¯ä¸Šè°ƒç”¨ä¸€æ¬¡ï¼Œå¹¶ä¸”å¿…é¡»åœ¨è°ƒç”¨ <a href="http://nodejs.cn/s/sqAtet" target="_blank" rel="noopener noreferrer"><code>response.end()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä¹‹å‰è°ƒç”¨ã€‚</p> <p>å½“ä½¿ç”¨ <a href="http://nodejs.cn/s/rqeM3J" target="_blank" rel="noopener noreferrer"><code>response.setHeader()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> è®¾ç½®å“åº”å¤´æ—¶ï¼Œåˆ™ä¸ä¼ ç»™ <a href="http://nodejs.cn/s/fnj9oM" target="_blank" rel="noopener noreferrer"><code>response.writeHead()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„ä»»ä½•å“åº”å¤´åˆå¹¶ï¼Œä¸” <a href="http://nodejs.cn/s/fnj9oM" target="_blank" rel="noopener noreferrer"><code>response.writeHead()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„ä¼˜å…ˆã€‚</p> <p>å¦‚æœè°ƒç”¨æ­¤æ–¹æ³•å¹¶ä¸”å°šæœªè°ƒç”¨ <a href="http://nodejs.cn/s/rqeM3J" target="_blank" rel="noopener noreferrer"><code>response.setHeader()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œåˆ™ç›´æ¥å°†æä¾›çš„å“åº”å¤´å€¼å†™å…¥ç½‘ç»œé€šé“è€Œä¸åœ¨å†…éƒ¨è¿›è¡Œç¼“å­˜ï¼Œå“åº”å¤´ä¸Šçš„ <a href="http://nodejs.cn/s/pbE7VN" target="_blank" rel="noopener noreferrer"><code>response.getHeader()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å°†ä¸ä¼šäº§ç”Ÿé¢„æœŸçš„ç»“æœã€‚ å¦‚æœéœ€è¦æ¸è¿›çš„å“åº”å¤´å¡«å……ä»¥åŠå°†æ¥å¯èƒ½çš„æ£€ç´¢å’Œä¿®æ”¹ï¼Œåˆ™æ”¹ç”¨ <a href="http://nodejs.cn/s/rqeM3J" target="_blank" rel="noopener noreferrer"><code>response.setHeader()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// è¿”å› content-type = text/plain</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'X-Foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/plain'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>Content-Length</code> ä»¥å­—èŠ‚è€Œéå­—ç¬¦ä¸ºå•ä½ã€‚ ä½¿ç”¨ <code>Buffer.byteLength()</code> æ¥åˆ¤æ–­ä¸»ä½“çš„é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚ Node.js ä¸æ£€æŸ¥ <code>Content-Length</code> å’Œå·²ä¼ è¾“çš„ä¸»ä½“çš„é•¿åº¦æ˜¯å¦ç›¸ç­‰ã€‚</p> <p>å°è¯•è®¾ç½®åŒ…å«æ— æ•ˆå­—ç¬¦çš„å“åº”å¤´å­—æ®µåç§°æˆ–å€¼å°†å¯¼è‡´æŠ›å‡º <a href="http://nodejs.cn/s/Z7Lqyj" target="_blank" rel="noopener noreferrer"><code>TypeError</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <h2 id="_9-http-get-options-callback-å’Œhttp-get-url-options-callback"><a href="#_9-http-get-options-callback-å’Œhttp-get-url-options-callback" class="header-anchor">ğŸŒ™</a> 9.<code>http.get(options[, callback])</code>å’Œ<code>http.get(url[, options][, callback])</code></h2> <ul><li><code>url</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> | <a href="http://nodejs.cn/s/5dwq7G" target="_blank" rel="noopener noreferrer"><URL><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></URL></a></li> <li><code>options</code> <a href="http://nodejs.cn/s/jzn6Ao" target="_blank" rel="noopener noreferrer"><Object><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Object></a> æ¥å—ä¸ <a href="http://nodejs.cn/s/d1myoL" target="_blank" rel="noopener noreferrer"><code>http.request()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ç›¸åŒçš„ <code>options</code>ï¼Œä¸” <code>method</code> å§‹ç»ˆè®¾ç½®ä¸º <code>GET</code>ã€‚ä»åŸå‹ç»§æ‰¿çš„å±æ€§å°†è¢«å¿½ç•¥ã€‚</li> <li><code>callback</code> <a href="http://nodejs.cn/s/ceTQa6" target="_blank" rel="noopener noreferrer"><Function><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Function></a>, <code>callback</code> è°ƒç”¨æ—¶åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œè¯¥å‚æ•°æ˜¯ <a href="http://nodejs.cn/s/2RqpEw" target="_blank" rel="noopener noreferrer"><code>http.IncomingMessage</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„å®ä¾‹ã€‚</li> <li>è¿”å›: <a href="http://nodejs.cn/s/2F5RHd" target="_blank" rel="noopener noreferrer">&lt;http.ClientRequest&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>è¿™ä¸ªæ–¹æ³•ä¸ <a href="http://nodejs.cn/s/d1myoL" target="_blank" rel="noopener noreferrer"><code>http.request()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„å”¯ä¸€åŒºåˆ«æ˜¯å®ƒå°†æ–¹æ³•è®¾ç½®ä¸º GET å¹¶è‡ªåŠ¨è°ƒç”¨ <code>req.end()</code></p> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://nodejs.cn/index.json'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> statusCode <span class="token punctuation">}</span> <span class="token operator">=</span> res<span class="token punctuation">;</span>
  <span class="token keyword">const</span> contentType <span class="token operator">=</span> res<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'content-type'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> error<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>statusCode <span class="token operator">!==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    error <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'è¯·æ±‚å¤±è´¥\n'</span> <span class="token operator">+</span>
                      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">çŠ¶æ€ç : </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>statusCode<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token regex">/^application\/json/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>contentType<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    error <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'æ— æ•ˆçš„ content-type.\n'</span> <span class="token operator">+</span>
                      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">æœŸæœ›çš„æ˜¯ application/json ä½†æ¥æ”¶åˆ°çš„æ˜¯ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>contentType<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ¶ˆè´¹å“åº”æ•°æ®æ¥é‡Šæ”¾å†…å­˜ã€‚</span>
    res<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  res<span class="token punctuation">.</span><span class="token function">setEncoding</span><span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> rawData <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> rawData <span class="token operator">+=</span> chunk<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> parsedData <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>rawData<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>parsedData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">å‡ºç°é”™è¯¯: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_10-http-request-options-callback-å’Œhttp-request-url-options-callback"><a href="#_10-http-request-options-callback-å’Œhttp-request-url-options-callback" class="header-anchor">ğŸŒ™</a> 10. <code>http.request(options[, callback])</code>å’Œ<code>http.request(url[, options][, callback])</code></h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> postData <span class="token operator">=</span> querystring<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string">'msg'</span><span class="token operator">:</span> <span class="token string">'ä½ å¥½ä¸–ç•Œ'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  hostname<span class="token operator">:</span> <span class="token string">'nodejs.cn'</span><span class="token punctuation">,</span>
  port<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
  path<span class="token operator">:</span> <span class="token string">'/upload'</span><span class="token punctuation">,</span>
  method<span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
  headers<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/x-www-form-urlencoded'</span><span class="token punctuation">,</span>
    <span class="token string">'Content-Length'</span><span class="token operator">:</span> Buffer<span class="token punctuation">.</span><span class="token function">byteLength</span><span class="token punctuation">(</span>postData<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> req <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">çŠ¶æ€ç : </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>res<span class="token punctuation">.</span>statusCode<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">å“åº”å¤´: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">setEncoding</span><span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">å“åº”ä¸»ä½“: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>chunk<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å“åº”ä¸­å·²æ— æ•°æ®'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">è¯·æ±‚é‡åˆ°é—®é¢˜: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å°†æ•°æ®å†™å…¥è¯·æ±‚ä¸»ä½“ã€‚</span>
req<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>postData<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å¿…é¡»å§‹ç»ˆè°ƒç”¨ req.end() æ¥è¡¨ç¤ºè¯·æ±‚çš„ç»“æŸ</span>
req<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><code>url</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> | <a href="http://nodejs.cn/s/5dwq7G" target="_blank" rel="noopener noreferrer"><URL><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></URL></a></li> <li><code>options</code> <a href="http://nodejs.cn/s/jzn6Ao" target="_blank" rel="noopener noreferrer"><Object><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Object></a> <ul><li><code>agent</code> <a href="http://nodejs.cn/s/HRCnER" target="_blank" rel="noopener noreferrer">&lt;http.Agent&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> | <a href="http://nodejs.cn/s/jFbvuT" target="_blank" rel="noopener noreferrer"><boolean><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></boolean></a> æ§åˆ¶ <a href="http://nodejs.cn/s/HRCnER" target="_blank" rel="noopener noreferrer"><code>Agent</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> çš„è¡Œä¸ºã€‚å¯èƒ½çš„å€¼æœ‰ï¼š
<ul><li><code>undefined</code> (é»˜è®¤): å¯¹æ­¤ä¸»æœºå’Œç«¯å£ä½¿ç”¨ <a href="http://nodejs.cn/s/g7BhW2" target="_blank" rel="noopener noreferrer"><code>http.globalAgent</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</li> <li><code>Agent</code> å¯¹è±¡: æ˜¾å¼åœ°ä½¿ç”¨ä¼ å…¥çš„ <code>Agent</code>ã€‚</li> <li><code>false</code>: ä½¿ç”¨æ–°å»ºçš„å…·æœ‰é»˜è®¤å€¼çš„ <code>Agent</code>ã€‚</li></ul></li> <li><code>auth</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> åŸºæœ¬çš„èº«ä»½éªŒè¯ï¼Œå³ <code>'user:password'</code>ï¼Œç”¨äºè®¡ç®—æˆæƒè¯·æ±‚å¤´ã€‚</li> <li><code>createConnection</code> <a href="http://nodejs.cn/s/ceTQa6" target="_blank" rel="noopener noreferrer"><Function><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Function></a> å½“ <code>agent</code> é€‰é¡¹æœªè¢«ä½¿ç”¨æ—¶ï¼Œç”¨æ¥ä¸ºè¯·æ±‚ç”Ÿæˆå¥—æ¥å­—æˆ–æµçš„å‡½æ•°ã€‚è¿™å¯ç”¨äºé¿å…åˆ›å»ºè‡ªå®šä¹‰çš„ <code>Agent</code> ç±»ä»¥è¦†ç›–é»˜è®¤çš„ <code>createConnection</code> å‡½æ•°ã€‚è¯¦è§ <a href="http://nodejs.cn/s/nH3X12" target="_blank" rel="noopener noreferrer"><code>agent.createConnection()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚ä»»ä½•<a href="http://nodejs.cn/s/2iRabr" target="_blank" rel="noopener noreferrer">åŒå·¥æµ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>éƒ½æ˜¯æœ‰æ•ˆçš„è¿”å›å€¼ã€‚</li> <li><code>defaultPort</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a> åè®®çš„é»˜è®¤ç«¯å£ã€‚ å¦‚æœä½¿ç”¨ <code>Agent</code>ï¼Œåˆ™é»˜è®¤å€¼ä¸º <code>agent.defaultPort</code>ï¼Œå¦åˆ™ä¸º <code>undefined</code>ã€‚</li> <li><code>family</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a> å½“è§£æ <code>host</code> æˆ– <code>hostname</code> æ—¶ä½¿ç”¨çš„ IP åœ°å€æ—ã€‚æœ‰æ•ˆå€¼ä¸º <code>4</code> æˆ– <code>6</code>ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™åŒæ—¶ä½¿ç”¨ IP v4 å’Œ v6ã€‚</li> <li><code>headers</code> <a href="http://nodejs.cn/s/jzn6Ao" target="_blank" rel="noopener noreferrer"><Object><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Object></a> åŒ…å«è¯·æ±‚å¤´çš„å¯¹è±¡ã€‚</li> <li><code>host</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> è¯·æ±‚å‘é€è‡³çš„æœåŠ¡å™¨çš„åŸŸåæˆ– IP åœ°å€ã€‚<strong>é»˜è®¤å€¼:</strong> <code>'localhost'</code>ã€‚</li> <li><code>hostname</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> <code>host</code> çš„åˆ«åã€‚ä¸ºäº†æ”¯æŒ <a href="http://nodejs.cn/s/b28B2A" target="_blank" rel="noopener noreferrer"><code>url.parse()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œå¦‚æœåŒæ—¶æŒ‡å®š <code>host</code> å’Œ <code>hostname</code>ï¼Œåˆ™ä½¿ç”¨ <code>hostname</code>ã€‚</li> <li><code>insecureHTTPParser</code> <a href="http://nodejs.cn/s/jFbvuT" target="_blank" rel="noopener noreferrer"><boolean><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></boolean></a> ä½¿ç”¨ä¸å®‰å…¨çš„ HTTP è§£æå™¨ï¼Œå½“ä¸º <code>true</code> æ—¶æ¥å—æ— æ•ˆçš„ HTTP è¯·æ±‚å¤´ã€‚åº”é¿å…ä½¿ç”¨ä¸å®‰å…¨çš„è§£æå™¨ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œå‚è§ <a href="http://nodejs.cn/s/5Bnm43" target="_blank" rel="noopener noreferrer"><code>--insecure-http-parser</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚<strong>é»˜è®¤å€¼:</strong> <code>false</code>ã€‚</li> <li><code>localAddress</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> ä¸ºç½‘ç»œè¿æ¥ç»‘å®šçš„æœ¬åœ°æ¥å£ã€‚</li> <li><code>lookup</code> <a href="http://nodejs.cn/s/ceTQa6" target="_blank" rel="noopener noreferrer"><Function><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Function></a> è‡ªå®šä¹‰çš„æŸ¥æ‰¾å‡½æ•°ã€‚ <strong>é»˜è®¤å€¼:</strong> <a href="http://nodejs.cn/s/LJLsTL" target="_blank" rel="noopener noreferrer"><code>dns.lookup()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</li> <li><code>maxHeaderSize</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a> å¯é€‰åœ°ï¼Œé‡å†™æ­¤æœåŠ¡å™¨æ¥æ”¶çš„è¯·æ±‚çš„ <a href="http://nodejs.cn/s/HfsyuU" target="_blank" rel="noopener noreferrer"><code>--max-http-header-size</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å€¼ï¼Œå³è¯·æ±‚å¤´çš„æœ€å¤§é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚ <strong>é»˜è®¤å€¼:</strong> 16384ï¼ˆ16KBï¼‰ã€‚</li> <li><code>method</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŒ‡å®š HTTP è¯·æ±‚çš„æ–¹æ³•ã€‚<strong>é»˜è®¤å€¼:</strong> <code>'GET'</code>ã€‚</li> <li><code>path</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> è¯·æ±‚çš„è·¯å¾„ã€‚åº”åŒ…æ‹¬æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚ä¾‹å¦‚ <code>'/index.html?page=12'</code>ã€‚å½“è¯·æ±‚çš„è·¯å¾„åŒ…å«éæ³•çš„å­—ç¬¦æ—¶ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚ç›®å‰åªæœ‰ç©ºæ ¼è¢«æ‹’ç»ï¼Œä½†æœªæ¥å¯èƒ½ä¼šæœ‰æ‰€å˜åŒ–ã€‚<strong>é»˜è®¤å€¼:</strong> <code>'/'</code>ã€‚</li> <li><code>port</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a> è¿œç¨‹æœåŠ¡å™¨çš„ç«¯å£ã€‚<strong>é»˜è®¤å€¼:</strong> <code>defaultPort</code>ï¼ˆå¦‚æœæœ‰è®¾ç½®ï¼‰æˆ– <code>80</code>ã€‚</li> <li><code>protocol</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> ä½¿ç”¨çš„åè®®ã€‚<strong>é»˜è®¤å€¼:</strong> <code>'http:'</code>ã€‚</li> <li><code>setHost</code> <a href="http://nodejs.cn/s/jFbvuT" target="_blank" rel="noopener noreferrer"><boolean><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></boolean></a>: æŒ‡å®šæ˜¯å¦è‡ªåŠ¨æ·»åŠ  <code>Host</code> è¯·æ±‚å¤´ã€‚<strong>é»˜è®¤å€¼:</strong> <code>true</code>ã€‚</li> <li><code>socketPath</code> <a href="http://nodejs.cn/s/9Tw2bK" target="_blank" rel="noopener noreferrer"><string><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></string></a> Unix åŸŸå¥—æ¥å­—ã€‚å¦‚æœæŒ‡å®šäº† <code>host</code> æˆ– <code>port</code> ä¹‹ä¸€ï¼ˆå®ƒä»¬æŒ‡å®šäº† TCP å¥—æ¥å­—ï¼‰ï¼Œåˆ™ä¸èƒ½ä½¿ç”¨æ­¤é€‰é¡¹ã€‚</li> <li><code>timeout</code> <a href="http://nodejs.cn/s/SXbo1v" target="_blank" rel="noopener noreferrer"><number><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></number></a>: æŒ‡å®šå¥—æ¥å­—è¶…æ—¶çš„æ•°å€¼ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚è¿™ä¼šåœ¨å¥—æ¥å­—è¢«è¿æ¥ä¹‹å‰è®¾ç½®è¶…æ—¶ã€‚</li></ul></li> <li><code>callback</code> <a href="http://nodejs.cn/s/ceTQa6" target="_blank" rel="noopener noreferrer"><Function><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></Function></a>,å¯é€‰çš„ <code>callback</code> å‚æ•°ä¼šä½œä¸ºå•æ¬¡ç›‘å¬å™¨è¢«æ·»åŠ åˆ° <a href="http://nodejs.cn/s/qwaiK8" target="_blank" rel="noopener noreferrer"><code>'response'</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> äº‹ä»¶ã€‚</li> <li>è¿”å›: <a href="http://nodejs.cn/s/2F5RHd" target="_blank" rel="noopener noreferrer">&lt;http.ClientRequest&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="_11-å°ç»“"><a href="#_11-å°ç»“" class="header-anchor">ğŸŒ™</a> 11. å°ç»“</h2> <ul><li><p>å¯¼å…¥httpæ¨¡å—</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>åˆ›å»ºæœåŠ¡å¹¶ç›‘å¬ç«¯å£</p> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> req</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// res: http.ServerResponseç±»</span>
    <span class="token comment">// req: http.ClientRequestç±»</span>
    response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ä¼˜å…ˆäºsetHeader</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">'Content-type'</span><span class="token operator">:</span> <span class="token string">'text/html;charset=UTF-8'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token comment">// å¿…é¡»è°ƒç”¨end()æ–¹æ³•</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>åˆ›å»ºgetè¯·æ±‚</p> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://nodejs.cn/index.json'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// do what you want</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>http.get</code>æ˜¯åˆ›å»ºhttpè¯·æ±‚GETæ–¹æ³•å¿«æ·æ–¹å¼ã€‚</p></li> <li><p>åˆ›å»ºpostè¯·æ±‚</p> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>method<span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><code>http.request</code>æ˜¯åˆ›å»ºhttpè¯·æ±‚ä¸‡èƒ½æ–¹æ³•ã€‚</p></li></ul> <blockquote><p>æœ¬æ–‡å­¦ä¹ ç¬”è®°å¤§éƒ¨åˆ†æ˜¯æŸ¥çœ‹å®˜ç½‘APIï¼Œéƒ¨åˆ†æ˜¯æŸ¥çœ‹nodejsæºç ï¼Œåªä¾›å‚è€ƒï¼Œä¸å–œå‹¿å–· (#^.^#)ã€‚</p></blockquote></boolean></boolean></boolean></div> <footer class="page-edit" style="display:none;"><div class="edit-link"><a href="https://github.com/qinhao305292690/edit/master/docs/backEnd/node/NodeJSä¹‹HTTPæ¨¡å—å­¦ä¹ ç¬”è®°.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°: </span> <span class="time">2020-6-24 10:27:17</span></div></footer> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-44bd5a18 data-v-44bd5a18><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-44bd5a18><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-44bd5a18></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-44bd5a18></path></svg></div><!----><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-5775ee02>
      æ¬¢è¿æ¥åˆ° èƒ¡å‰‘é”‹
    </div> <div class="operation" style="right:90px;bottom:40px;display:;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:;" data-v-5775ee02></i></div> <canvas id="banniang" width="150" height="220" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    çœ‹æ¿å¨˜
  </div></div><div class="reco-bgm-panel" data-v-39f9e6e0><audio id="bgm" src="/my-blog/music/austin/Austin.mp3" data-v-39f9e6e0></audio> <div class="reco-float-box" style="bottom:200px;z-index:999999;display:none;" data-v-39f9e6e0 data-v-41bcba48 data-v-39f9e6e0><img src="/my-blog/music/austin/ladygaga.jpg" data-v-39f9e6e0></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-39f9e6e0 data-v-41bcba48 data-v-39f9e6e0><div class="reco-bgm-cover" style="background-image:url(/my-blog/music/austin/ladygaga.jpg);" data-v-39f9e6e0><div class="mini-operation" style="display:none;" data-v-39f9e6e0><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-39f9e6e0></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-39f9e6e0></i></div> <div class="falut-message" style="display:none;" data-v-39f9e6e0>
          æ’­æ”¾å¤±è´¥
        </div></div> <div class="reco-bgm-info" data-v-39f9e6e0 data-v-41bcba48 data-v-39f9e6e0><div class="info-box" data-v-39f9e6e0><i class="reco-bgm reco-bgm-music music" data-v-39f9e6e0></i>austin</div> <div class="info-box" data-v-39f9e6e0><i class="reco-bgm reco-bgm-artist" data-v-39f9e6e0></i>send'it</div> <div class="reco-bgm-progress" data-v-39f9e6e0><div class="progress-bar" data-v-39f9e6e0><div class="bar" data-v-39f9e6e0></div></div></div> <div class="reco-bgm-operation" data-v-39f9e6e0><i class="reco-bgm reco-bgm-last last" data-v-39f9e6e0></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-39f9e6e0></i> <i class="reco-bgm reco-bgm-play play" data-v-39f9e6e0></i> <i class="reco-bgm reco-bgm-next next" data-v-39f9e6e0></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-39f9e6e0></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-39f9e6e0></i> <div class="volume-bar" data-v-39f9e6e0><div class="bar" data-v-39f9e6e0></div></div></div></div> <div class="reco-bgm-left-box" data-v-39f9e6e0 data-v-41bcba48 data-v-39f9e6e0><i class="reco-bgm reco-bgm-left" data-v-39f9e6e0></i></div></div></div></div></div>
    <script src="/my-blog/assets/js/app.237f5998.js" defer></script><script src="/my-blog/assets/js/4.c3b56a13.js" defer></script><script src="/my-blog/assets/js/1.f2d47305.js" defer></script><script src="/my-blog/assets/js/16.d2346b3e.js" defer></script><script src="/my-blog/assets/js/10.020a3d41.js" defer></script>
  </body>
</html>
